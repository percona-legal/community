<!doctype html><html lang=en prefix="og: https://ogp.me/ns#"><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,minimum-scale=1"><title>TiSpark: More Data Insights, No More ETL | Percona Community</title><meta name=description content="When we released TiDB 2.0 in April, part of that announcement also included the release of TiSpark 1.0&ndash;an integral part of the TiDB platform that makes complex analytics on ‚Äúfresh‚Äù transactional data possible. Since then, many people in the TiDB community have been asking for more information about TiSpark. In this post, I will explain the motivation, inner workings, and future roadmap of this project.
Motivation The motivation behind building TiSpark was to enable real-time analytics on TiDB without the delay and challenges of ETL."><link rel=canonical href=https://percona.community/blog/2018-06-18-tispark-data-insights-no-etl/><meta name=robots content="noindex,nofollow"><meta property="og:title" content="TiSpark: More Data Insights, No More ETL"><meta property="og:description" content="When we released TiDB 2.0 in April, part of that announcement also included the release of TiSpark 1.0&ndash;an integral part of the TiDB platform that makes complex analytics on ‚Äúfresh‚Äù transactional data possible. Since then, many people in the TiDB community have been asking for more information about TiSpark. In this post, I will explain the motivation, inner workings, and future roadmap of this project.
Motivation The motivation behind building TiSpark was to enable real-time analytics on TiDB without the delay and challenges of ETL."><meta property="og:type" content="article"><meta property="og:url" content="https://percona.community/blog/2018-06-18-tispark-data-insights-no-etl/"><meta name=image property="og:image" content="https://percona.community/blog/2018/06/tspark-query-path_hu0efb144fef14b6a11e85d71e26a11e71_184964_1200x0_resize_q90_bgffffff_lanczos_2.jpg"><meta property="article:published_time" content="2018-06-18T13:41:53+00:00"><meta property="article:modified_time" content="2018-06-18T13:41:53+00:00"><meta property="article:section" content="blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://percona.community/blog/2018/06/tspark-query-path.png"><meta name=twitter:title content="TiSpark: More Data Insights, No More ETL | Percona Community"><meta name=twitter:description content="When we released TiDB 2.0 in April, part of that announcement also included the release of TiSpark 1.0&ndash;an integral part of the TiDB platform that makes complex analytics on ‚Äúfresh‚Äù transactional data possible. Since then, many people in the TiDB community have been asking for more information about TiSpark. In this post, I will explain the motivation, inner workings, and future roadmap of this project.
Motivation The motivation behind building TiSpark was to enable real-time analytics on TiDB without the delay and challenges of ETL."><meta name=twitter:site content="@Percona"><meta name=twitter:creator content="@https://twitter.com/PingCAP"><meta name=description content="When we released TiDB 2.0 in April, part of that announcement also included the release of TiSpark 1.0&ndash;an integral part of the TiDB platform that makes complex analytics on ‚Äúfresh‚Äù transactional data possible. Since then, many people in the TiDB community have been asking for more information about TiSpark. In this post, I will explain the motivation, inner workings, and future roadmap of this project.
Motivation The motivation behind building TiSpark was to enable real-time analytics on TiDB without the delay and challenges of ETL."><meta name=copyright content="¬© Percona Community. MySQL, InnoDB, MariaDB and MongoDB are trademarks of their respective owners.
"><meta name=author content="PingCAP"><style>@charset "UTF-8";html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;vertical-align:baseline}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after{content:none}q:before,q:after{content:none}table{border-collapse:collapse;border-spacing:0}html,body{font-family:Arial,sans-serif;scroll-behavior:smooth;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;line-height:1.5rem;font-feature-settings:"liga" 1;font-weight:500;font-size:18px}@media(min-width:900px){html,body{font-size:20px}}@media(min-width:1100px){html,body{font-size:22px}}@media(min-width:1800px){html,body{font-size:24px}}@media print{html,body{font-size:18px}}hr{border:0;height:2px;background-color:#fe7f2d;margin-top:1.5rem;margin-bottom:1.5rem}.text{position:relative}.text .meta{font-variant:small-caps}.text .meta .byline{display:none}.text .meta .line{display:inline-block}.text .meta .calendar{display:none}.text h1,.text h2,.text h3,.text h4,.text h5,.text h6{font-family:Georgia,palatino linotype,book antiqua,Palatino,times new roman,serif;font-weight:500;page-break-after:avoid}.text h1 a,.text h1 a:visited,.text h2 a,.text h2 a:visited,.text h3 a,.text h3 a:visited,.text h4 a,.text h4 a:visited,.text h5 a,.text h5 a:visited,.text h6 a,.text h6 a:visited{color:#2a2d34;text-decoration:none}.text p,.text ul,.text ol,.text figure,.text dl,.text hr{margin-top:1.5rem;font-size:1rem}.text q{font-style:italic}.text ul ul{margin-top:0}.text p>code,.text ul>code,.text ol>code,.text dt>code,.text dd>code,.text li>code{color:#009b72}.text button{cursor:pointer;display:inline-block;box-sizing:border-box;border:.1rem solid #6761a8;height:1.5rem;padding-left:.75rem;padding-right:.75rem;border-radius:.2rem;transition:color .233s ease-in-out,background-color .233s ease-in-out}.text button:hover{color:#fff;background-color:#6761a8}.text audio{display:block;width:100%;height:1.5rem;outline:none}.text audio span{line-height:1.5rem}.text dl{overflow:auto;position:relative}.text dt{font-weight:700}.text dd{padding-left:2rem}.text dd+dt{margin-top:1.5rem}.text ul{list-style-type:disc;padding-left:1.5rem}.text ol{list-style-type:decimal;padding-left:1.5rem}.text p{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.text h1{font-size:2.5rem;font-weight:500;line-height:3rem;margin-top:1.5rem;margin-bottom:0}@media screen and (min-width:760px){.text h1{font-size:3.5rem;line-height:4.5rem;margin-top:1.5rem}}@media screen and (min-width:900px){.text h1{font-size:4rem;line-height:4.5rem;margin-top:3rem}}@media screen and (min-width:1400px){.text h1{font-size:5rem;line-height:6rem;margin-top:6rem}}.text h2{font-size:2rem;line-height:3rem;margin-top:3rem;margin-bottom:3rem}.text h3{font-size:1.5rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h4{font-size:1rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h5{font-size:.8rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h6{font-size:.6rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text strong{font-weight:700}.text em{font-style:italic}.text blockquote{border-left:.2rem solid #999;padding-left:.75rem}.text code{font-family:lucida console,Monaco,monospace;speak:literal-punctuation}.text abbr,.text acronym{speak:spell-out}.text del{text-decoration:line-through}.text ins{text-decoration:none;font-style:italic}.text figure{position:relative;text-align:center}.text figure img{background:#fff;border-radius:.2rem;max-width:100%}.text figure table{min-width:75%;border-radius:.2rem;margin-left:auto;margin-right:auto;border:#6761a8;border-collapse:separate;border-spacing:0;background:#fff;margin-bottom:-.1em}.text figure table th,.text figure table td{padding-left:.75rem;padding-right:.75rem;line-height:1.3rem;border-left:.1rem solid #6761a8;border-top:.1rem solid #6761a8}.text figure table thead{background-color:#fff}.text figure table tr td:last-child,.text figure table tr th:last-child{border-right:.1rem solid #6761a8}.text figure table tbody:last-child tr:last-child td{border-bottom:.1rem solid #6761a8}.text figure table thead:first-child tr:first-child th:first-child,.text figure table thead:first-child tr:first-child td:first-child{border-top-left-radius:.2rem}.text figure table thead:first-child tr:first-child,.text figure table thead:first-child tr:first-child th:last-child,.text figure table thead:first-child tr:first-child td:last-child{border-top-right-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:first-child{border-bottom-left-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:last-child{border-bottom-right-radius:.2rem}.text figure ul{text-align:left}.text figure ul.tree{padding-top:1.5em;padding-bottom:1.5em;border-radius:.2rem;background:#fff}.text figure ul.tree li{list-style-type:none}.text figure ul.tree .tree__item--folder::before{content:"üìÅ";margin-right:.2em}.text figure ul.tree .tree__item--file::before{content:"üìù";margin-right:.2em}.text figure figcaption{font-style:italic}.text pre{margin-top:1.5rem;font-size:inherit;line-height:1.5rem;padding:1.5rem 1.5rem .75rem;white-space:pre;overflow-x:scroll;overflow-y:hidden;scrollbar-color:#cccccc transparent;scrollbar-width:.75rem}.text pre::-webkit-scrollbar{margin-top:-.75rem;height:.75rem}.text pre::-webkit-scrollbar-track{background:0 0}.text pre::-webkit-scrollbar-thumb{height:.1rem;border-radius:.2rem;background:#ccc}.text hr{border:0;height:.2rem;background:#6761a8;margin-top:1.3rem}.text .admonition{position:relative}.text .admonition>*{padding-left:2rem}.text .admonition>:first-child::before{display:block;text-align:left;position:absolute;top:0;left:0;width:.75rem;font-size:1rem;line-height:1.5rem;height:1.5rem}.text .admonition--tip>:first-child::before{content:"‚òõ";color:#00a000;font-size:1.5rem;line-height:1.5rem;height:1.5rem}.text .admonition--warning>:first-child::before{content:"‚ö†Ô∏è";color:#fe7f2d}.text .admonition--info>:first-child::before{content:"‚ìò";color:#004966;font-weight:700}@media print{.text h1{margin-left:auto;margin-right:auto;margin-top:9rem;width:80%;font-variant:small-caps;text-align:center}.text--simple h1{margin-top:0}.text .meta{page-break-after:always;text-align:center;font-size:1.2rem;margin-top:1.5rem}.text .meta a{text-decoration:none}.text .meta time{display:none}.text .body p:first-of-type{margin-top:0}.text pre{padding:0;font-size:inherit;line-height:1.5rem;overflow:hidden;white-space:pre-wrap;word-break:break-all}}.text .podcasts{margin-top:1.5rem;text-align:center}.text a.podcast{display:block;height:3rem}.text a.podcast img{width:50%;max-width:200px}@media screen and (min-width:768px){.text .podcasts{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));grid-gap:1.5rem}.text a.podcast img{width:100%}}.text .tombstone{opacity:0}html,body{min-height:100vh}body{text-align:center}@media screen{body{color:#2a2d34;background-color:#fefefe}}@media print{body{color:#000;background:#fff}}@media screen{body{display:flex;flex-direction:column}main.page{width:100%;flex:1}}header.page,main.page,footer.page{text-align:left}.page-main,.contentblock{max-width:1400px;padding-left:1.5rem;padding-right:1.5rem;margin-left:auto;margin-right:auto}@media print{.page-main,.contentblock{padding:0}}@page{size:A4;padding:0;margin:3rem}.highlight{color:#6761a8}.nobr{white-space:nowrap}.aria-only{display:none}@media aural{.aria-only{display:block}}a{color:#004966;text-decoration-color:#a2dffb;transition:color .233s ease-out,text-decoration-color .233s ease-out}a:hover,a:visited:hover{color:#fe7f2d}a:active{color:#fe7f2d}a:visited{color:#6761a8;text-decoration-color:#009b72}html,body{font-family:Arial,sans-serif;scroll-behavior:smooth;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;line-height:1.5rem;font-feature-settings:"liga" 1;font-weight:500;font-size:18px}@media(min-width:900px){html,body{font-size:20px}}@media(min-width:1100px){html,body{font-size:22px}}@media(min-width:1800px){html,body{font-size:24px}}@media print{html,body{font-size:18px}}hr{border:0;height:2px;background-color:#fe7f2d;margin-top:1.5rem;margin-bottom:1.5rem}.text{position:relative}.text .meta{font-variant:small-caps}.text .meta .byline{display:none}.text .meta .line{display:inline-block}.text .meta .calendar{display:none}.text h1,.text h2,.text h3,.text h4,.text h5,.text h6{font-family:Georgia,palatino linotype,book antiqua,Palatino,times new roman,serif;font-weight:500;page-break-after:avoid}.text h1 a,.text h1 a:visited,.text h2 a,.text h2 a:visited,.text h3 a,.text h3 a:visited,.text h4 a,.text h4 a:visited,.text h5 a,.text h5 a:visited,.text h6 a,.text h6 a:visited{color:#2a2d34;text-decoration:none}.text p,.text ul,.text ol,.text figure,.text dl,.text hr{margin-top:1.5rem;font-size:1rem}.text q{font-style:italic}.text ul ul{margin-top:0}.text p>code,.text ul>code,.text ol>code,.text dt>code,.text dd>code,.text li>code{color:#009b72}.text button{cursor:pointer;display:inline-block;box-sizing:border-box;border:.1rem solid #6761a8;height:1.5rem;padding-left:.75rem;padding-right:.75rem;border-radius:.2rem;transition:color .233s ease-in-out,background-color .233s ease-in-out}.text button:hover{color:#fff;background-color:#6761a8}.text audio{display:block;width:100%;height:1.5rem;outline:none}.text audio span{line-height:1.5rem}.text dl{overflow:auto;position:relative}.text dt{font-weight:700}.text dd{padding-left:2rem}.text dd+dt{margin-top:1.5rem}.text ul{list-style-type:disc;padding-left:1.5rem}.text ol{list-style-type:decimal;padding-left:1.5rem}.text p{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.text h1{font-size:2.5rem;font-weight:500;line-height:3rem;margin-top:1.5rem;margin-bottom:0}@media screen and (min-width:760px){.text h1{font-size:3.5rem;line-height:4.5rem;margin-top:1.5rem}}@media screen and (min-width:900px){.text h1{font-size:4rem;line-height:4.5rem;margin-top:3rem}}@media screen and (min-width:1400px){.text h1{font-size:5rem;line-height:6rem;margin-top:6rem}}.text h2{font-size:2rem;line-height:3rem;margin-top:3rem;margin-bottom:3rem}.text h3{font-size:1.5rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h4{font-size:1rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h5{font-size:.8rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h6{font-size:.6rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text strong{font-weight:700}.text em{font-style:italic}.text blockquote{border-left:.2rem solid #999;padding-left:.75rem}.text code{font-family:lucida console,Monaco,monospace;speak:literal-punctuation}.text abbr,.text acronym{speak:spell-out}.text del{text-decoration:line-through}.text ins{text-decoration:none;font-style:italic}.text figure{position:relative;text-align:center}.text figure img{background:#fff;border-radius:.2rem;max-width:100%}.text figure table{min-width:75%;border-radius:.2rem;margin-left:auto;margin-right:auto;border:#6761a8;border-collapse:separate;border-spacing:0;background:#fff;margin-bottom:-.1em}.text figure table th,.text figure table td{padding-left:.75rem;padding-right:.75rem;line-height:1.3rem;border-left:.1rem solid #6761a8;border-top:.1rem solid #6761a8}.text figure table thead{background-color:#fff}.text figure table tr td:last-child,.text figure table tr th:last-child{border-right:.1rem solid #6761a8}.text figure table tbody:last-child tr:last-child td{border-bottom:.1rem solid #6761a8}.text figure table thead:first-child tr:first-child th:first-child,.text figure table thead:first-child tr:first-child td:first-child{border-top-left-radius:.2rem}.text figure table thead:first-child tr:first-child,.text figure table thead:first-child tr:first-child th:last-child,.text figure table thead:first-child tr:first-child td:last-child{border-top-right-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:first-child{border-bottom-left-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:last-child{border-bottom-right-radius:.2rem}.text figure ul{text-align:left}.text figure ul.tree{padding-top:1.5em;padding-bottom:1.5em;border-radius:.2rem;background:#fff}.text figure ul.tree li{list-style-type:none}.text figure ul.tree .tree__item--folder::before{content:"üìÅ";margin-right:.2em}.text figure ul.tree .tree__item--file::before{content:"üìù";margin-right:.2em}.text figure figcaption{font-style:italic}.text pre{margin-top:1.5rem;font-size:inherit;line-height:1.5rem;padding:1.5rem 1.5rem .75rem;white-space:pre;overflow-x:scroll;overflow-y:hidden;scrollbar-color:#cccccc transparent;scrollbar-width:.75rem}.text pre::-webkit-scrollbar{margin-top:-.75rem;height:.75rem}.text pre::-webkit-scrollbar-track{background:0 0}.text pre::-webkit-scrollbar-thumb{height:.1rem;border-radius:.2rem;background:#ccc}.text hr{border:0;height:.2rem;background:#6761a8;margin-top:1.3rem}.text .admonition{position:relative}.text .admonition>*{padding-left:2rem}.text .admonition>:first-child::before{display:block;text-align:left;position:absolute;top:0;left:0;width:.75rem;font-size:1rem;line-height:1.5rem;height:1.5rem}.text .admonition--tip>:first-child::before{content:"‚òõ";color:#00a000;font-size:1.5rem;line-height:1.5rem;height:1.5rem}.text .admonition--warning>:first-child::before{content:"‚ö†Ô∏è";color:#fe7f2d}.text .admonition--info>:first-child::before{content:"‚ìò";color:#004966;font-weight:700}@media print{.text h1{margin-left:auto;margin-right:auto;margin-top:9rem;width:80%;font-variant:small-caps;text-align:center}.text--simple h1{margin-top:0}.text .meta{page-break-after:always;text-align:center;font-size:1.2rem;margin-top:1.5rem}.text .meta a{text-decoration:none}.text .meta time{display:none}.text .body p:first-of-type{margin-top:0}.text pre{padding:0;font-size:inherit;line-height:1.5rem;overflow:hidden;white-space:pre-wrap;word-break:break-all}}.text .podcasts{margin-top:1.5rem;text-align:center}.text a.podcast{display:block;height:3rem}.text a.podcast img{width:50%;max-width:200px}@media screen and (min-width:768px){.text .podcasts{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));grid-gap:1.5rem}.text a.podcast img{width:100%}}.text .tombstone{opacity:0}.page-header a{display:block;text-decoration:none;height:2.6rem;line-height:2.6rem;border-top:.2rem solid transparent;border-bottom:.2rem solid transparent}.page-header a,.page-header a span{transition:color .233s ease-in-out,border-bottom .233s,margin-bottom .233s}.page-header a:hover{color:#004966;border-bottom:.2rem solid #004966}.page-header a:hover span{color:#004966}.page-header a img{height:2.6rem}.page-header a{color:#2a2d34;border-bottom:0 solid #fefefe}.page-header a:hover{color:#004966;border-bottom-color:#004966}.page-header a:visited{color:#2a2d34}.page-header a{display:block;border-bottom-width:0;font-weight:700}.page-header .logo{z-index:6;font-size:1.2rem;font-weight:700;font-variant:small-caps}.page-header .logo a{margin-top:.2rem;text-decoration:none;display:block;border:none}#show-mobile-menu{display:none}.mobile-toggle{display:none}@media screen and (max-width:759px){header.page{box-shadow:0 0 3px rgba(168,168,168,.5)}.logo a{position:absolute}.page-header{justify-content:space-between;z-index:1}.hamburger-bar{height:.2rem;background:#2a2d34;margin-top:.2rem;display:block}#show-mobile-menu+.mobile-toggle+.mobile-menu nav{background:#fefefe}#show-mobile-menu+.mobile-toggle .hamburger-bar{transform:translateY(0)rotate(0);opacity:1;transition:transform .233s ease-in-out,opacity .233s ease-in-out}#show-mobile-menu:checked+.mobile-toggle{position:fixed;right:1.5rem}#show-mobile-menu:checked+.mobile-toggle .hamburger-bar:nth-of-type(1){transform:translateY(.4rem)rotate(315deg)}#show-mobile-menu:checked+.mobile-toggle .hamburger-bar:nth-of-type(2){opacity:0}#show-mobile-menu:checked+.mobile-toggle .hamburger-bar:nth-of-type(3){transform:translateY(-.4rem)rotate(405deg)}.mobile-toggle{cursor:pointer;display:block;width:1.2rem;height:1rem;z-index:5;margin-top:.75rem}.mobile-toggle label,.mobile-toggle .hamburger-bar{cursor:pointer}.mobile-menu{overflow:hidden;position:fixed;top:0;left:0;right:0;bottom:100vh;opacity:0;background:rgba(0,0,0,.5);transition:opacity .233s ease-in-out,bottom .233s ease-in-out}#show-mobile-menu:checked+.mobile-toggle+.mobile-menu{opacity:1;bottom:0}.hide-mobile-menu{display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:2}.mobile-menu nav{box-sizing:border-box;max-height:100%;position:absolute;top:0;left:0;right:0;z-index:3;font-size:1rem;line-height:3rem;padding:3rem 1.5rem 1.5rem;display:flex;flex-direction:column}.mobile-menu nav header{display:flex;flex-direction:row;font-size:inherit;line-height:inherit}.mobile-menu nav header h1{margin-top:0;font-size:1.2rem;line-height:1.5rem;flex:1;font-variant:small-caps}.mobile-menu nav header .hide-mobile-menu-aria{display:block;z-index:10;height:1.5rem;width:1.5rem}.mobile-menu nav ul{overflow-y:scroll;flex:1;scrollbar-width:none;-ms-overflow-style:none}.mobile-menu nav ul::-webkit-scrollbar{width:0;background:0 0}.mobile-menu nav a:hover{border-bottom:0;margin-bottom:0}}@media screen and (min-width:760px){.page-header .mobile-toggle{display:none}.page-header .mobile-menu{flex:1}.page-header nav{flex:1}.page-header nav header{display:none}.page-header ul{list-style-type:none}.page-header nav ul{display:flex;align-items:end;justify-content:flex-end;flex-direction:row}.page-header nav li{padding-left:1.5rem}.page-header nav li.active a{border-bottom-width:3px;border-bottom-color:#6761a8}}@media screen{.page-header{position:relative;max-width:1400px;margin-left:auto;margin-right:auto;padding-left:1.5rem;padding-right:1.5rem;height:3rem;display:flex;flex-direction:row}}@media print{header.page{display:none}}@media screen and (max-width:759px) and (prefers-reduced-motion:reduce){.mobile-menu{transition:none}#show-mobile-menu+.mobile-toggle .hamburger-bar{transition:none}}@media screen and (max-width:759px) and (prefers-reduced-transparency:reduce){.mobile-menu{background:gray}}html,body{font-family:Arial,sans-serif;scroll-behavior:smooth;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;line-height:1.5rem;font-feature-settings:"liga" 1;font-weight:500;font-size:18px}@media(min-width:900px){html,body{font-size:20px}}@media(min-width:1100px){html,body{font-size:22px}}@media(min-width:1800px){html,body{font-size:24px}}@media print{html,body{font-size:18px}}hr{border:0;height:2px;background-color:#fe7f2d;margin-top:1.5rem;margin-bottom:1.5rem}.text{position:relative}.text .meta{font-variant:small-caps}.text .meta .byline{display:none}.text .meta .line{display:inline-block}.text .meta .calendar{display:none}.text h1,.text h2,.text h3,.text h4,.text h5,.text h6{font-family:Georgia,palatino linotype,book antiqua,Palatino,times new roman,serif;font-weight:500;page-break-after:avoid}.text h1 a,.text h1 a:visited,.text h2 a,.text h2 a:visited,.text h3 a,.text h3 a:visited,.text h4 a,.text h4 a:visited,.text h5 a,.text h5 a:visited,.text h6 a,.text h6 a:visited{color:#2a2d34;text-decoration:none}.text p,.text ul,.text ol,.text figure,.text dl,.text hr{margin-top:1.5rem;font-size:1rem}.text q{font-style:italic}.text ul ul{margin-top:0}.text p>code,.text ul>code,.text ol>code,.text dt>code,.text dd>code,.text li>code{color:#009b72}.text button{cursor:pointer;display:inline-block;box-sizing:border-box;border:.1rem solid #6761a8;height:1.5rem;padding-left:.75rem;padding-right:.75rem;border-radius:.2rem;transition:color .233s ease-in-out,background-color .233s ease-in-out}.text button:hover{color:#fff;background-color:#6761a8}.text audio{display:block;width:100%;height:1.5rem;outline:none}.text audio span{line-height:1.5rem}.text dl{overflow:auto;position:relative}.text dt{font-weight:700}.text dd{padding-left:2rem}.text dd+dt{margin-top:1.5rem}.text ul{list-style-type:disc;padding-left:1.5rem}.text ol{list-style-type:decimal;padding-left:1.5rem}.text p{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.text h1{font-size:2.5rem;font-weight:500;line-height:3rem;margin-top:1.5rem;margin-bottom:0}@media screen and (min-width:760px){.text h1{font-size:3.5rem;line-height:4.5rem;margin-top:1.5rem}}@media screen and (min-width:900px){.text h1{font-size:4rem;line-height:4.5rem;margin-top:3rem}}@media screen and (min-width:1400px){.text h1{font-size:5rem;line-height:6rem;margin-top:6rem}}.text h2{font-size:2rem;line-height:3rem;margin-top:3rem;margin-bottom:3rem}.text h3{font-size:1.5rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h4{font-size:1rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h5{font-size:.8rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h6{font-size:.6rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text strong{font-weight:700}.text em{font-style:italic}.text blockquote{border-left:.2rem solid #999;padding-left:.75rem}.text code{font-family:lucida console,Monaco,monospace;speak:literal-punctuation}.text abbr,.text acronym{speak:spell-out}.text del{text-decoration:line-through}.text ins{text-decoration:none;font-style:italic}.text figure{position:relative;text-align:center}.text figure img{background:#fff;border-radius:.2rem;max-width:100%}.text figure table{min-width:75%;border-radius:.2rem;margin-left:auto;margin-right:auto;border:#6761a8;border-collapse:separate;border-spacing:0;background:#fff;margin-bottom:-.1em}.text figure table th,.text figure table td{padding-left:.75rem;padding-right:.75rem;line-height:1.3rem;border-left:.1rem solid #6761a8;border-top:.1rem solid #6761a8}.text figure table thead{background-color:#fff}.text figure table tr td:last-child,.text figure table tr th:last-child{border-right:.1rem solid #6761a8}.text figure table tbody:last-child tr:last-child td{border-bottom:.1rem solid #6761a8}.text figure table thead:first-child tr:first-child th:first-child,.text figure table thead:first-child tr:first-child td:first-child{border-top-left-radius:.2rem}.text figure table thead:first-child tr:first-child,.text figure table thead:first-child tr:first-child th:last-child,.text figure table thead:first-child tr:first-child td:last-child{border-top-right-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:first-child{border-bottom-left-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:last-child{border-bottom-right-radius:.2rem}.text figure ul{text-align:left}.text figure ul.tree{padding-top:1.5em;padding-bottom:1.5em;border-radius:.2rem;background:#fff}.text figure ul.tree li{list-style-type:none}.text figure ul.tree .tree__item--folder::before{content:"üìÅ";margin-right:.2em}.text figure ul.tree .tree__item--file::before{content:"üìù";margin-right:.2em}.text figure figcaption{font-style:italic}.text pre{margin-top:1.5rem;font-size:inherit;line-height:1.5rem;padding:1.5rem 1.5rem .75rem;white-space:pre;overflow-x:scroll;overflow-y:hidden;scrollbar-color:#cccccc transparent;scrollbar-width:.75rem}.text pre::-webkit-scrollbar{margin-top:-.75rem;height:.75rem}.text pre::-webkit-scrollbar-track{background:0 0}.text pre::-webkit-scrollbar-thumb{height:.1rem;border-radius:.2rem;background:#ccc}.text hr{border:0;height:.2rem;background:#6761a8;margin-top:1.3rem}.text .admonition{position:relative}.text .admonition>*{padding-left:2rem}.text .admonition>:first-child::before{display:block;text-align:left;position:absolute;top:0;left:0;width:.75rem;font-size:1rem;line-height:1.5rem;height:1.5rem}.text .admonition--tip>:first-child::before{content:"‚òõ";color:#00a000;font-size:1.5rem;line-height:1.5rem;height:1.5rem}.text .admonition--warning>:first-child::before{content:"‚ö†Ô∏è";color:#fe7f2d}.text .admonition--info>:first-child::before{content:"‚ìò";color:#004966;font-weight:700}@media print{.text h1{margin-left:auto;margin-right:auto;margin-top:9rem;width:80%;font-variant:small-caps;text-align:center}.text--simple h1{margin-top:0}.text .meta{page-break-after:always;text-align:center;font-size:1.2rem;margin-top:1.5rem}.text .meta a{text-decoration:none}.text .meta time{display:none}.text .body p:first-of-type{margin-top:0}.text pre{padding:0;font-size:inherit;line-height:1.5rem;overflow:hidden;white-space:pre-wrap;word-break:break-all}}.text .podcasts{margin-top:1.5rem;text-align:center}.text a.podcast{display:block;height:3rem}.text a.podcast img{width:50%;max-width:200px}@media screen and (min-width:768px){.text .podcasts{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));grid-gap:1.5rem}.text a.podcast img{width:100%}}.text .tombstone{opacity:0}html,body{min-height:100vh}body{text-align:center}@media screen{body{color:#2a2d34;background-color:#fefefe}}@media print{body{color:#000;background:#fff}}@media screen{body{display:flex;flex-direction:column}main.page{width:100%;flex:1}}header.page,main.page,footer.page{text-align:left}.page-main,.contentblock{max-width:1400px;padding-left:1.5rem;padding-right:1.5rem;margin-left:auto;margin-right:auto}@media print{.page-main,.contentblock{padding:0}}@page{size:A4;padding:0;margin:3rem}.highlight{color:#6761a8}.nobr{white-space:nowrap}.aria-only{display:none}@media aural{.aria-only{display:block}}a{color:#004966;text-decoration-color:#a2dffb;transition:color .233s ease-out,text-decoration-color .233s ease-out}a:hover,a:visited:hover{color:#fe7f2d}a:active{color:#fe7f2d}a:visited{color:#6761a8;text-decoration-color:#009b72}footer.page{margin-top:1.5rem}footer.page h2{font-size:1rem}@media not print{footer.page{margin-top:1.5rem/2;padding-top:1.5rem/2;padding-bottom:1.5rem/2}.page-footer{max-width:1400px;padding-left:1.5rem;padding-right:1.5rem;margin-left:auto;margin-right:auto;font-size:.7rem;line-height:1.5rem}}@media not print{.page-footer ul{margin-bottom:1.5rem}.page-footer a{display:block;text-decoration:none;height:2.6rem;line-height:2.6rem;border-top:.2rem solid transparent;border-bottom:.2rem solid transparent}.page-footer a,.page-footer a span{transition:color .233s ease-in-out,border-bottom .233s,margin-bottom .233s}.page-footer a:hover{color:#004966;border-bottom:.2rem solid #004966}.page-footer a:hover span{color:#004966}.page-footer a img{height:2.6rem}.page-footer nav ul{display:flex;flex-direction:row;align-items:center;justify-content:center;margin-bottom:0;height:1.5rem;line-height:1.5rem}.page-footer nav ul a{height:1.3rem;line-height:1.3rem;text-align:center;display:block;padding-left:.75rem;padding-right:.75rem;border-bottom:.2rem solid transparent}}@media print{footer.page nav{display:none}footer.page aside{border-top:.2rem solid #333;margin-top:.65rem;padding-top:.65rem}}footer.page{border-top:2px solid #fe7f2d;margin-top:-2px}footer.page aside{text-align:center;font-size:.6rem;line-height:1.5rem;color:#333}@media screen{footer.page{background-color:#fefefe}.page-footer a{color:#2a2d34;border-bottom:0 solid #fefefe}.page-footer a:hover{color:#004966;border-bottom-color:#004966}.page-footer a:visited{color:#2a2d34}}.grid{display:grid;gap:1.5rem 1.5rem;font-size:.9rem;margin-bottom:1.5rem;margin-top:1.5rem}.grid--2{grid-template-columns:1fr 1fr}.grid--3{grid-template-columns:1fr 1fr 1fr}.grid--4{grid-template-columns:1fr 1fr 1fr}.grid img{max-width:100%}.grid h2{font-size:1.2rem;margin-bottom:.75rem}.grid p{margin-bottom:.75rem}@media(max-width:768px){.grid--2{display:block}}@media(max-width:1200px){.grid--3{display:block}}@media(max-width:1600px){.grid--4{display:block}}.post--preview{display:block;border-radius:.3rem;padding-bottom:.375rem}.post--preview img{margin-bottom:.375rem}.post--preview h2,.post--preview p{padding-left:.5rem;padding-right:.5rem}.post--preview :last-child{margin-bottom:0}.post--preview:hover{box-shadow:0 0 1.5rem #666666}a.post--preview,a.post--preview *{text-decoration:none;color:#2a2d34}a.post--preview .readmore,a.post--preview * .readmore{font-weight:700}.hero{background-color:#004966;background-position:50%;background-repeat:no-repeat;background-size:cover;color:#fff}.hero h1{margin-bottom:1.5rem}.hero a{color:#fff;font-weight:700;border-bottom:2px solid #fff;text-decoration:none;transition:color .233s ease-out,border-bottom-color .233s ease-out}.hero a:hover,.hero a:visited:hover{color:#fff;border-bottom-color:#fe7f2d}.hero img{float:left;margin-right:1.5rem}.hero:nth-child(4n+2),.hero:nth-child(4n+4){background-color:initial;color:#2a2d34}.hero:nth-child(4n+2) img,.hero:nth-child(4n+4) img{float:right;margin-right:0;margin-left:1.5rem}.hero:nth-child(4n+2) a,.hero:nth-child(4n+4) a{color:#2a2d34}.hero:nth-child(4n+2) a:hover,.hero:nth-child(4n+4) a:hover{color:#2a2d34}.hero:nth-child(4n+3){background-color:#fe7f2d}.hero--bio .contentblock{text-align:center}.hero--bio .contentblock img{text-align:center;float:none;margin-bottom:1.5rem}.hero--bio .contentblock p{text-align:left}@media(min-width:769px){.hero--bio .contentblock{min-height:240px;text-align:left}.hero--bio .contentblock img{float:right;margin-left:1.5rem;margin-bottom:0}}.contentblock{padding-top:3rem;padding-bottom:3rem}.herotext{font-size:1.2rem;background:rgba(0,0,0,.5);padding:1.5rem;border-radius:.75rem}.herotext p{margin-top:1.5rem}.herotext p:first-child{margin-top:0}.herotext small{font-size:.8rem}html,body{font-family:Arial,sans-serif;scroll-behavior:smooth;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;line-height:1.5rem;font-feature-settings:"liga" 1;font-weight:500;font-size:18px}@media(min-width:900px){html,body{font-size:20px}}@media(min-width:1100px){html,body{font-size:22px}}@media(min-width:1800px){html,body{font-size:24px}}@media print{html,body{font-size:18px}}hr{border:0;height:2px;background-color:#fe7f2d;margin-top:1.5rem;margin-bottom:1.5rem}.text{position:relative}.text .meta{font-variant:small-caps}.text .meta .byline{display:none}.text .meta .line{display:inline-block}.text .meta .calendar{display:none}.text h1,.text h2,.text h3,.text h4,.text h5,.text h6{font-family:Georgia,palatino linotype,book antiqua,Palatino,times new roman,serif;font-weight:500;page-break-after:avoid}.text h1 a,.text h1 a:visited,.text h2 a,.text h2 a:visited,.text h3 a,.text h3 a:visited,.text h4 a,.text h4 a:visited,.text h5 a,.text h5 a:visited,.text h6 a,.text h6 a:visited{color:#2a2d34;text-decoration:none}.text p,.text ul,.text ol,.text figure,.text dl,.text hr{margin-top:1.5rem;font-size:1rem}.text q{font-style:italic}.text ul ul{margin-top:0}.text p>code,.text ul>code,.text ol>code,.text dt>code,.text dd>code,.text li>code{color:#009b72}.text button{cursor:pointer;display:inline-block;box-sizing:border-box;border:.1rem solid #6761a8;height:1.5rem;padding-left:.75rem;padding-right:.75rem;border-radius:.2rem;transition:color .233s ease-in-out,background-color .233s ease-in-out}.text button:hover{color:#fff;background-color:#6761a8}.text audio{display:block;width:100%;height:1.5rem;outline:none}.text audio span{line-height:1.5rem}.text dl{overflow:auto;position:relative}.text dt{font-weight:700}.text dd{padding-left:2rem}.text dd+dt{margin-top:1.5rem}.text ul{list-style-type:disc;padding-left:1.5rem}.text ol{list-style-type:decimal;padding-left:1.5rem}.text p{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.text h1{font-size:2.5rem;font-weight:500;line-height:3rem;margin-top:1.5rem;margin-bottom:0}@media screen and (min-width:760px){.text h1{font-size:3.5rem;line-height:4.5rem;margin-top:1.5rem}}@media screen and (min-width:900px){.text h1{font-size:4rem;line-height:4.5rem;margin-top:3rem}}@media screen and (min-width:1400px){.text h1{font-size:5rem;line-height:6rem;margin-top:6rem}}.text h2{font-size:2rem;line-height:3rem;margin-top:3rem;margin-bottom:3rem}.text h3{font-size:1.5rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h4{font-size:1rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h5{font-size:.8rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h6{font-size:.6rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text strong{font-weight:700}.text em{font-style:italic}.text blockquote{border-left:.2rem solid #999;padding-left:.75rem}.text code{font-family:lucida console,Monaco,monospace;speak:literal-punctuation}.text abbr,.text acronym{speak:spell-out}.text del{text-decoration:line-through}.text ins{text-decoration:none;font-style:italic}.text figure{position:relative;text-align:center}.text figure img{background:#fff;border-radius:.2rem;max-width:100%}.text figure table{min-width:75%;border-radius:.2rem;margin-left:auto;margin-right:auto;border:#6761a8;border-collapse:separate;border-spacing:0;background:#fff;margin-bottom:-.1em}.text figure table th,.text figure table td{padding-left:.75rem;padding-right:.75rem;line-height:1.3rem;border-left:.1rem solid #6761a8;border-top:.1rem solid #6761a8}.text figure table thead{background-color:#fff}.text figure table tr td:last-child,.text figure table tr th:last-child{border-right:.1rem solid #6761a8}.text figure table tbody:last-child tr:last-child td{border-bottom:.1rem solid #6761a8}.text figure table thead:first-child tr:first-child th:first-child,.text figure table thead:first-child tr:first-child td:first-child{border-top-left-radius:.2rem}.text figure table thead:first-child tr:first-child,.text figure table thead:first-child tr:first-child th:last-child,.text figure table thead:first-child tr:first-child td:last-child{border-top-right-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:first-child{border-bottom-left-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:last-child{border-bottom-right-radius:.2rem}.text figure ul{text-align:left}.text figure ul.tree{padding-top:1.5em;padding-bottom:1.5em;border-radius:.2rem;background:#fff}.text figure ul.tree li{list-style-type:none}.text figure ul.tree .tree__item--folder::before{content:"üìÅ";margin-right:.2em}.text figure ul.tree .tree__item--file::before{content:"üìù";margin-right:.2em}.text figure figcaption{font-style:italic}.text pre{margin-top:1.5rem;font-size:inherit;line-height:1.5rem;padding:1.5rem 1.5rem .75rem;white-space:pre;overflow-x:scroll;overflow-y:hidden;scrollbar-color:#cccccc transparent;scrollbar-width:.75rem}.text pre::-webkit-scrollbar{margin-top:-.75rem;height:.75rem}.text pre::-webkit-scrollbar-track{background:0 0}.text pre::-webkit-scrollbar-thumb{height:.1rem;border-radius:.2rem;background:#ccc}.text hr{border:0;height:.2rem;background:#6761a8;margin-top:1.3rem}.text .admonition{position:relative}.text .admonition>*{padding-left:2rem}.text .admonition>:first-child::before{display:block;text-align:left;position:absolute;top:0;left:0;width:.75rem;font-size:1rem;line-height:1.5rem;height:1.5rem}.text .admonition--tip>:first-child::before{content:"‚òõ";color:#00a000;font-size:1.5rem;line-height:1.5rem;height:1.5rem}.text .admonition--warning>:first-child::before{content:"‚ö†Ô∏è";color:#fe7f2d}.text .admonition--info>:first-child::before{content:"‚ìò";color:#004966;font-weight:700}@media print{.text h1{margin-left:auto;margin-right:auto;margin-top:9rem;width:80%;font-variant:small-caps;text-align:center}.text--simple h1{margin-top:0}.text .meta{page-break-after:always;text-align:center;font-size:1.2rem;margin-top:1.5rem}.text .meta a{text-decoration:none}.text .meta time{display:none}.text .body p:first-of-type{margin-top:0}.text pre{padding:0;font-size:inherit;line-height:1.5rem;overflow:hidden;white-space:pre-wrap;word-break:break-all}}.text .podcasts{margin-top:1.5rem;text-align:center}.text a.podcast{display:block;height:3rem}.text a.podcast img{width:50%;max-width:200px}@media screen and (min-width:768px){.text .podcasts{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));grid-gap:1.5rem}.text a.podcast img{width:100%}}.text .tombstone{opacity:0}.paginator{margin-top:1.5rem;text-align:center}.paginator a{display:inline-block;text-decoration:none;border-radius:3px;color:#2a2d34;border:1px solid #2a2d34;transition:.2s background-color ease-in-out,.2s color ease-in-out,.2s border-color ease-in-out;height:1rem;width:1rem;line-height:1rem;font-size:.7rem;margin-left:.2rem;margin-right:.2rem}.paginator a:hover,.paginator a.active{background:#004966;color:#fefefe;border:1px solid #004966}@media screen and (min-width:768px){.paginator a{height:1.5rem;width:1.5rem;line-height:1.5rem;font-size:1rem}}@media screen and (min-width:900px){.paginator a{height:3rem;width:3rem;line-height:3rem;font-size:1.2rem}}html,body{font-family:Arial,sans-serif;scroll-behavior:smooth;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;line-height:1.5rem;font-feature-settings:"liga" 1;font-weight:500;font-size:18px}@media(min-width:900px){html,body{font-size:20px}}@media(min-width:1100px){html,body{font-size:22px}}@media(min-width:1800px){html,body{font-size:24px}}@media print{html,body{font-size:18px}}hr{border:0;height:2px;background-color:#fe7f2d;margin-top:1.5rem;margin-bottom:1.5rem}.text{position:relative}.text .meta{font-variant:small-caps}.text .meta .byline{display:none}.text .meta .line{display:inline-block}.text .meta .calendar{display:none}.text h1,.text h2,.text h3,.text h4,.text h5,.text h6{font-family:Georgia,palatino linotype,book antiqua,Palatino,times new roman,serif;font-weight:500;page-break-after:avoid}.text h1 a,.text h1 a:visited,.text h2 a,.text h2 a:visited,.text h3 a,.text h3 a:visited,.text h4 a,.text h4 a:visited,.text h5 a,.text h5 a:visited,.text h6 a,.text h6 a:visited{color:#2a2d34;text-decoration:none}.text p,.text ul,.text ol,.text figure,.text dl,.text hr{margin-top:1.5rem;font-size:1rem}.text q{font-style:italic}.text ul ul{margin-top:0}.text p>code,.text ul>code,.text ol>code,.text dt>code,.text dd>code,.text li>code{color:#009b72}.text button{cursor:pointer;display:inline-block;box-sizing:border-box;border:.1rem solid #6761a8;height:1.5rem;padding-left:.75rem;padding-right:.75rem;border-radius:.2rem;transition:color .233s ease-in-out,background-color .233s ease-in-out}.text button:hover{color:#fff;background-color:#6761a8}.text audio{display:block;width:100%;height:1.5rem;outline:none}.text audio span{line-height:1.5rem}.text dl{overflow:auto;position:relative}.text dt{font-weight:700}.text dd{padding-left:2rem}.text dd+dt{margin-top:1.5rem}.text ul{list-style-type:disc;padding-left:1.5rem}.text ol{list-style-type:decimal;padding-left:1.5rem}.text p{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.text h1{font-size:2.5rem;font-weight:500;line-height:3rem;margin-top:1.5rem;margin-bottom:0}@media screen and (min-width:760px){.text h1{font-size:3.5rem;line-height:4.5rem;margin-top:1.5rem}}@media screen and (min-width:900px){.text h1{font-size:4rem;line-height:4.5rem;margin-top:3rem}}@media screen and (min-width:1400px){.text h1{font-size:5rem;line-height:6rem;margin-top:6rem}}.text h2{font-size:2rem;line-height:3rem;margin-top:3rem;margin-bottom:3rem}.text h3{font-size:1.5rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h4{font-size:1rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h5{font-size:.8rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h6{font-size:.6rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text strong{font-weight:700}.text em{font-style:italic}.text blockquote{border-left:.2rem solid #999;padding-left:.75rem}.text code{font-family:lucida console,Monaco,monospace;speak:literal-punctuation}.text abbr,.text acronym{speak:spell-out}.text del{text-decoration:line-through}.text ins{text-decoration:none;font-style:italic}.text figure{position:relative;text-align:center}.text figure img{background:#fff;border-radius:.2rem;max-width:100%}.text figure table{min-width:75%;border-radius:.2rem;margin-left:auto;margin-right:auto;border:#6761a8;border-collapse:separate;border-spacing:0;background:#fff;margin-bottom:-.1em}.text figure table th,.text figure table td{padding-left:.75rem;padding-right:.75rem;line-height:1.3rem;border-left:.1rem solid #6761a8;border-top:.1rem solid #6761a8}.text figure table thead{background-color:#fff}.text figure table tr td:last-child,.text figure table tr th:last-child{border-right:.1rem solid #6761a8}.text figure table tbody:last-child tr:last-child td{border-bottom:.1rem solid #6761a8}.text figure table thead:first-child tr:first-child th:first-child,.text figure table thead:first-child tr:first-child td:first-child{border-top-left-radius:.2rem}.text figure table thead:first-child tr:first-child,.text figure table thead:first-child tr:first-child th:last-child,.text figure table thead:first-child tr:first-child td:last-child{border-top-right-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:first-child{border-bottom-left-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:last-child{border-bottom-right-radius:.2rem}.text figure ul{text-align:left}.text figure ul.tree{padding-top:1.5em;padding-bottom:1.5em;border-radius:.2rem;background:#fff}.text figure ul.tree li{list-style-type:none}.text figure ul.tree .tree__item--folder::before{content:"üìÅ";margin-right:.2em}.text figure ul.tree .tree__item--file::before{content:"üìù";margin-right:.2em}.text figure figcaption{font-style:italic}.text pre{margin-top:1.5rem;font-size:inherit;line-height:1.5rem;padding:1.5rem 1.5rem .75rem;white-space:pre;overflow-x:scroll;overflow-y:hidden;scrollbar-color:#cccccc transparent;scrollbar-width:.75rem}.text pre::-webkit-scrollbar{margin-top:-.75rem;height:.75rem}.text pre::-webkit-scrollbar-track{background:0 0}.text pre::-webkit-scrollbar-thumb{height:.1rem;border-radius:.2rem;background:#ccc}.text hr{border:0;height:.2rem;background:#6761a8;margin-top:1.3rem}.text .admonition{position:relative}.text .admonition>*{padding-left:2rem}.text .admonition>:first-child::before{display:block;text-align:left;position:absolute;top:0;left:0;width:.75rem;font-size:1rem;line-height:1.5rem;height:1.5rem}.text .admonition--tip>:first-child::before{content:"‚òõ";color:#00a000;font-size:1.5rem;line-height:1.5rem;height:1.5rem}.text .admonition--warning>:first-child::before{content:"‚ö†Ô∏è";color:#fe7f2d}.text .admonition--info>:first-child::before{content:"‚ìò";color:#004966;font-weight:700}@media print{.text h1{margin-left:auto;margin-right:auto;margin-top:9rem;width:80%;font-variant:small-caps;text-align:center}.text--simple h1{margin-top:0}.text .meta{page-break-after:always;text-align:center;font-size:1.2rem;margin-top:1.5rem}.text .meta a{text-decoration:none}.text .meta time{display:none}.text .body p:first-of-type{margin-top:0}.text pre{padding:0;font-size:inherit;line-height:1.5rem;overflow:hidden;white-space:pre-wrap;word-break:break-all}}.text .podcasts{margin-top:1.5rem;text-align:center}.text a.podcast{display:block;height:3rem}.text a.podcast img{width:50%;max-width:200px}@media screen and (min-width:768px){.text .podcasts{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));grid-gap:1.5rem}.text a.podcast img{width:100%}}.text .tombstone{opacity:0}.text .chroma{font-size:.8rem;border-radius:.2rem}.text .chroma .lntd{vertical-align:top;padding:0;margin:0;border:0}.text .chroma .lntable{border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block}.text .chroma .hl{display:block;width:100%}.text .chroma .lnt{margin-right:.4em;padding:0 .4em}.text .chroma{color:#272822}@media screen{.text .chroma{background-color:#fafafa}}.text .chroma .err{color:#960050}.text .chroma .hl{background-color:#ffc}.text .chroma .lnt{margin-right:.4em;padding:0 .4em;color:#7f7f7f}.text .chroma .ln{color:#7f7f7f}.text .chroma .k{color:#00a8c8}.text .chroma .kc{color:#00a8c8}.text .chroma .kd{color:#00a8c8}.text .chroma .kn{color:#f92672}.text .chroma .kp{color:#00a8c8}.text .chroma .kr{color:#00a8c8}.text .chroma .kt{color:#00a8c8}.text .chroma .n{color:#111}.text .chroma .na{color:#75af00}.text .chroma .nb{color:#111}.text .chroma .bp{color:#111}.text .chroma .nc{color:#75af00}.text .chroma .no{color:#00a8c8}.text .chroma .nd{color:#75af00}.text .chroma .ni{color:#111}.text .chroma .ne{color:#75af00}.text .chroma .nf{color:#75af00}.text .chroma .fm{color:#111}.text .chroma .nl{color:#111}.text .chroma .nn{color:#111}.text .chroma .nx{color:#75af00}.text .chroma .py{color:#111}.text .chroma .nt{color:#f92672}.text .chroma .nv{color:#111}.text .chroma .vc{color:#111}.text .chroma .vg{color:#111}.text .chroma .vi{color:#111}.text .chroma .vm{color:#111}.text .chroma .l{color:#ae81ff}.text .chroma .ld{color:#d88200}.text .chroma .s{color:#d88200}.text .chroma .sa{color:#d88200}.text .chroma .sb{color:#d88200}.text .chroma .sc{color:#d88200}.text .chroma .dl{color:#d88200}.text .chroma .sd{color:#d88200}.text .chroma .s2{color:#d88200}.text .chroma .se{color:#8045ff}.text .chroma .sh{color:#d88200}.text .chroma .si{color:#d88200}.text .chroma .sx{color:#d88200}.text .chroma .sr{color:#d88200}.text .chroma .s1{color:#d88200}.text .chroma .ss{color:#d88200}.text .chroma .m{color:#ae81ff}.text .chroma .mb{color:#ae81ff}.text .chroma .mf{color:#ae81ff}.text .chroma .mh{color:#ae81ff}.text .chroma .mi{color:#ae81ff}.text .chroma .il{color:#ae81ff}.text .chroma .mo{color:#ae81ff}.text .chroma .o{color:#f92672}.text .chroma .ow{color:#f92672}.text .chroma .p{color:#111}.text .chroma .c{color:#75715e}.text .chroma .ch{color:#75715e}.text .chroma .cm{color:#75715e}.text .chroma .c1{color:#75715e}.text .chroma .cs{color:#75715e}.text .chroma .cp{color:#75715e}.text .chroma .cpf{color:#75715e}.text .chroma .ge{font-style:italic}.text .chroma .gs{font-weight:700}</style><meta name=color-scheme content="dark light"></head><body><header><div class=page-header><div class=logo><a href=/><img src="data:image/svg+xml,%3Csvg baseProfile=%22tiny%22 id=%22Capa_1%22 xmlns=%22http://www.w3.org/2000/svg%22 xmlns:xlink=%22http://www.w3.org/1999/xlink%22 viewBox=%220 0 650 210%22%3E%3Cg%3E%3Cg%3E%3Ccircle fill=%22%23fff%22 cx=%22100.91%22 cy=%22104.98%22 r=%2268.91%22/%3E%3Cg%3E%3Cpath fill=%22%23bf181a%22 d=%22M100.91 36.12C62.85 36.12 32 66.97 32 105.03c0 23.47 11.74 44.18 29.66 56.63v-56.63c0-21.68 17.57-39.25 39.25-39.25s39.25 17.57 39.25 39.25-17.57 39.25-39.25 39.25c-8.76.0-16.82-2.91-23.35-7.76v33.35c7.29 2.63 15.15 4.07 23.35 4.07 38.06.0 68.91-30.85 68.91-68.91s-30.86-68.91-68.91-68.91z%22/%3E%3Ccircle fill=%22%23efc700%22 cx=%22100.91%22 cy=%22105.03%22 r=%2222.96%22/%3E%3Cpath fill=%22%23e6b600%22 d=%22M100.91 84.32c12.3.0 22.31 9.68 22.9 21.83.02-.38.06-.75.06-1.13.0-12.68-10.28-22.96-22.96-22.96s-22.96 10.28-22.96 22.96c0 .38.04.75.06 1.13C78.6 94 88.61 84.32 100.91 84.32z%22/%3E%3C/g%3E%3C/g%3E%3Cpath fill=%22%233c3c3c%22 d=%22M213.3 128.11V81.98h19.29c10.51.0 17.3 6.16 17.3 15.7.0 9.39-7.11 15.95-17.3 15.95h-9.02v14.47H213.3zm18.71-23.13c4.84.0 7.61-2.66 7.61-7.29.0-4.54-2.7-7.04-7.61-7.04h-8.45v14.33H232.01z%22/%3E%3Cpolygon fill=%22%233c3c3c%22 points=%22272.12,128.11 272.12,81.98 304.8,81.98 304.8,90.71 282.39,90.71 282.39,100.36 302.88,100.36 302.88,109.15 282.39,109.15 282.39,119.38 304.87,119.38 304.87,128.11%22/%3E%3Cpath fill=%22%233c3c3c%22 d=%22M354.71 128.11l-8.2-14.35h-8.39v14.35h-10.26V81.98h20.89c10.24.0 16.85 6.24 16.85 15.89.0 6.29-3.19 11.52-8.56 14.12l9.56 16.11H354.71zM347.66 105.23c4.81.0 7.68-2.77 7.68-7.42.0-4.59-2.8-7.23-7.68-7.23h-9.53v14.65H347.66z%22/%3E%3Cpath fill=%22%233c3c3c%22 d=%22M470.47 129.01c-12.53.0-20.63-8.12-20.63-20.69v-6.53c0-12.57 8.1-20.69 20.63-20.69 12.72.0 20.63 7.93 20.63 20.69v6.53C491.1 121.08 483.19 129.01 470.47 129.01zm0-39.2c-6.59.0-10.37 4.2-10.37 11.52v7.43c0 7.32 3.78 11.52 10.37 11.52 6.59.0 10.36-4.2 10.36-11.52v-7.43C480.83 94.01 477.06 89.81 470.47 89.81z%22/%3E%3Cpolygon fill=%22%233c3c3c%22 points=%22543.01,128.11 524.48,99.79 524.48,128.11 514.41,128.11 514.41,81.98 523.93,81.98 542.46,110.3 542.46,81.98 552.53,81.98 552.53,128.11%22/%3E%3Cpath fill=%22%233c3c3c%22 d=%22M607.7 128.11l-3.01-9.41h-16.47l-3.01 9.41h-10.29l16.54-46.13h10.01L618 128.11H607.7zM601.98 110.29l-5.52-17.45-5.58 17.45h11.1z%22/%3E%3Cg%3E%3Cpath fill=%22%233c3c3c%22 d=%22M418.62 111.85c-.77 5.33-4.37 8.5-9.73 8.5-8.74.0-10.05-7.3-10.05-11.65v-7.3c0-4.35 1.31-11.65 10.05-11.65 5.35.0 8.95 3.15 9.73 8.45l9.52-1.42c-1.28-9.33-8.95-15.7-19.24-15.7-12.68.0-20.24 7.76-20.24 20.76v6.4c0 13 7.57 20.76 20.24 20.76 10.3.0 17.98-6.39 19.25-15.74L418.62 111.85z%22/%3E%3C/g%3E%3C/g%3E%3C/svg%3E" alt=Percona></a></div><input type=checkbox id=show-mobile-menu value=1 aria-hidden=true><div class=mobile-toggle aria-controls=mobile-menu aria-label="Open navigation" role=button><label for=show-mobile-menu id=hamburger><span class=hamburger-bar></span><span class=hamburger-bar></span><span class=hamburger-bar></span></label></div><div class=mobile-menu id=mobile-menu aria-labelledby=navigation-header role=dialog aria-modal=false aria-hidden=true><nav><ul><li><a href=/blog><span>Blog</span></a></li><li><a href=/resources><span>Resources</span></a></li><li><a href=/projects><span>Projects</span></a></li><li><a href=/contribute><span>Contribute</span></a></li></ul></nav></div></div></header><main class=page><div class=page-main><article class=text itemscope itemtype=https://schema.org/BlogPosting><meta itemprop=image content="https://percona.community/blog/2018/06/tspark-query-path.png"><meta itemprop=mainEntityOfPage content="https://percona.community/blog/2018-06-18-tispark-data-insights-no-etl/"><meta itemprop=keywords content="author_pingcap, ETL, extract transform and load, NewSQL, Open Source Databases, TiDB, TiSpark"><h1 itemprop="name headline">TiSpark: More Data Insights, No More ETL</h1><div class=meta><time datetime="2018-06-18 13:41:53 +0000 UTC" itemprop=datePublished><span class=line>June 18, 2018</span>
<span class=calendar><span class=day>18</span>
<span class=month-year>Jun 2018</span></span></time>
<span class=authors>by <a href=/authors/pingcap/>PingCAP</a></span></div><div itemprop=articleBody class=body><p>When we released <a href=http://bit.ly/tidb_2_0 target=_blank rel="noopener noreferrer">TiDB 2.0</a> in April, part of that announcement also included the release of <a href=https://github.com/pingcap/tispark target=_blank rel="noopener noreferrer">TiSpark</a> 1.0&ndash;an integral part of the TiDB platform that makes complex analytics on ‚Äúfresh‚Äù transactional data possible. Since then, many people in the TiDB community have been asking for more information about TiSpark. In this post, I will explain the motivation, inner workings, and future roadmap of this project.</p><h2 id=motivation>Motivation</h2><p>The motivation behind building TiSpark was to enable real-time analytics on TiDB without the delay and challenges of ETL. <a href=https://en.wikipedia.org/wiki/Extract,_transform,_load target=_blank rel="noopener noreferrer">Extract, transform, and load (ETL)</a>&ndash;a process to extract data from operational databases, transform that data, then load it into a database designed to supporting analytics&ndash;has been one of the most complex, tedious, error-prone, and therefore disliked tasks for many data engineers. However, it was a necessary evil to make data useful, because there hasn‚Äôt been good solutions on the market to render ETL obsolete&ndash;until now.</p><p>With the emergence of open-source database solutions like TiDB, the promise of a hybrid transactional and analytical processing (HTAP) architecture, a term first coined by <a href=https://www.gartner.com/doc/3599217/market-guide-htapenabling-inmemory-computing target=_blank rel="noopener noreferrer">Gartner</a>, is fast becoming a reality. Whether you subscribe to HTAP or other similar terms, like hybrid operational and analytical workloads (HOAP) (by <a href="https://451research.com/report-short?entityId=93844" target=_blank rel="noopener noreferrer">451 Research</a>) or ‚ÄúTranslytical‚Äù (by <a href=https://www.forrester.com/report/The+Forrester+Wave+Translytical+Data+Platforms+Q4+2017/-/E-RES134282 target=_blank rel="noopener noreferrer">Forrester</a>), it‚Äôs clear that the industry is calling for an end to the separation of the online transactional processing (OLTP) and online analytical processing (OLAP). No one wants to deal with ETL anymore.</p><p>To make this possible, PingCAP and its open source contributors built <a href=https://github.com/pingcap/tidb target=_blank rel="noopener noreferrer">TiDB</a> and <a href=https://github.com/pingcap/tispark target=_blank rel="noopener noreferrer">TiSpark</a>, which was recognized in a recent report from <a href="https://451research.com/report-short?entityId=95082" target=_blank rel="noopener noreferrer">451 Research</a> as an open source, modular NewSQL database that can be deployed to handle both operational and analytical workloads. TiSpark, which tightly integrates Apache Spark with <a href=https://github.com/pingcap/tikv target=_blank rel="noopener noreferrer">TiKV</a>, a distributed transactional key-value store on the TiDB platform, allows our customers to access operational data that was just recorded inside TiKV and run complex analytical queries on it right away. (If you are interested in experiencing an HTAP database on your laptop with TiDB + TiSpark, check out this <a href=https://pingcap.com/blog/how_to_spin_up_an_htap_database_in_5_minutes_with_tidb_tispark/ target=_blank rel="noopener noreferrer">5-minute tutorial</a> to spin up a cluster using Docker-Compose!)</p><h2 id=so-how-does-tispark-work>So How Does TiSpark Work?</h2><p>TiSpark leverages the power and popularity of <a href=https://en.wikipedia.org/wiki/Apache_Spark target=_blank rel="noopener noreferrer">Spark</a> with TiKV to enhance TiDB‚Äôs OLAP capabilities. Spark is a unified analytics engine that supports many big data use cases with a nice SQL interface (aka Spark SQL). TiDB from its very first day was built to be a relational SQL database with horizontal scalability; currently it‚Äôs compatible with MySQL. ¬†While TiDB has a complex and powerful optimizer and coprocessor architecture to support ad-hoc OLAP queries using MySQL, it‚Äôs even better to leverage a feature-rich engine like Spark to complete the missing piece in the HTAP puzzle. Thus, TiSpark was born.</p><p>TiSpark is a connector that supports the following features:</p><ul><li><p>Complex calculation pushdown: this feature produces better performance by pushing down complex calculations to TiKV</p></li><li><p>Key-range pruning: examines the sorted keys in TiKV and only returns the results we need</p></li><li><p>Index support for:</p><ul><li>Clustered index / non-clustered index</li><li>Index only query optimization</li></ul></li><li><p>Cost-based optimization for:</p><ul><li>Histogram support</li><li>Index selection</li></ul></li></ul><p>Here‚Äôs high-level overview of TiSpark‚Äôs architecture inside TiDB:</p><p><figure><img sizes=100vw srcset="/blog/2018/06/tispark-architecture_hu5659d043cc705a51129b1c2043b14523_201392_480x0_resize_lanczos_2.png 480w, /blog/2018/06/tispark-architecture_hu5659d043cc705a51129b1c2043b14523_201392_768x0_resize_lanczos_2.png 768w, /blog/2018/06/tispark-architecture_hu5659d043cc705a51129b1c2043b14523_201392_1024x0_resize_lanczos_2.png 1024w" src=/blog/2018/06/tispark-architecture.png alt="TiSpark Architecture inside TiDB"></figure></p><p>As you can see from the architecture diagram, TiSpark works with <a href=https://github.com/pingcap/pd target=_blank rel="noopener noreferrer">Placement Driver</a> (PD), the metadata cluster of TiDB to retrieve snapshots of data location, drives the query plans into the coprocessor layer, and retrieves the data directly from TiKV, where data is actually stored and persisted.</p><p>Before we go further, let‚Äôs have a better understanding of TiKV first. TiKV has a computing module called coprocessor, which can process most of the expression evaluations inside of ¬†TiKV itself. And as your TiKV cluster grows, coprocessors expand as well. This is one of the most important reasons why TiDB as a whole scales so well both in terms of capacity and performance.</p><p>For TiSpark to leverage these features inside TiKV, it makes use of Spark‚Äôs extension point called ‚ÄòExperimentalMethods,‚Äô because the current Spark data source API doesn‚Äôt give users the ability to execute complex calculations pushdown.</p><p><figure><img sizes=100vw srcset="/blog/2018/06/experimental-methods_hu8f9c032d918cc75bedf115d0e8793b5c_108696_480x0_resize_lanczos_2.png 480w, /blog/2018/06/experimental-methods_hu8f9c032d918cc75bedf115d0e8793b5c_108696_768x0_resize_lanczos_2.png 768w, /blog/2018/06/experimental-methods_hu8f9c032d918cc75bedf115d0e8793b5c_108696_1024x0_resize_lanczos_2.png 1024w" src=/blog/2018/06/experimental-methods.png alt="experimental methods"></figure></p><p>These extension points expose SQL compiler‚Äôs optimization and planning details, thus allowing developers to configure the internal behaviors of almost every aspect of SQL compilation. They are at the core of TiSpark‚Äôs power. Now, we can inject our own rules and do extra work to push down more computations, such as predicates, aggregation pushdown, and Top-N pushdown (LIMIT clause with ORDER BY).</p><h2 id=tispark-in-action>TiSpark in Action</h2><p>Let‚Äôs use an example to illustrate how TiSpark works in action. Suppose we have a <code>student</code> table, and there are two indices associated with it: primary index (clustered index) on column <code>studentId</code> and a secondary index on <code>school</code> column. We want to run the following query on this table:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>select class, avg(score) from student
where school = ‚Äòengineering‚Äô and lottery(name) = ‚Äòpicked‚Äô
and studentId &gt;= 8000 and studentId &lt; 10100
group by class;

</code></pre></div><p>The above query contains two predicates, each of which matches an index. TiSpark will first analyze the predicates combination and ‚Äúapproximate‚Äù how many rows will be returned if a specific index is applied. The goal here is to find a way to access the table with minimum cost. The process of finding an access path will be explained later. For now, let‚Äôs first look at how predicates are processed.</p><h3 id=path-1-primary-index>Path 1: Primary Index</h3><p>Assume we pick the <code>studentID</code> index, the primary index, to access the table. The process is as follows:</p><ol><li>Transform the predicates ‚ÄústudentId >= 8000 and studentId &lt; 10100‚Äù into a close-open interval on studentID: [8000, 10100);</li><li>Prune the irrelavant ‚Äò<a href=https://pingcap.com/blog/2017-07-11-tidbinternal1/#region target=_blank rel="noopener noreferrer">regions</a>‚Äô according to the above interval and the internal data distribution information in TiKV. For the clustered index column, TiKV uses the column to split and distribute data among different TiKV nodes. If we have a value interval on ‚ÄòstudentId,‚Äô we can directly prune all the ‚Äòregions‚Äô that are outside of the interval.</li><li>Convert the interval into coprocessor requests [8000, 10000), [10000, 10100), respectively, for both region 2 and 3 (and ignore region 1, as illustrated below) and get the data via a sequential scan.</li></ol><p><figure><img sizes=100vw srcset="/blog/2018/06/example-query1_hu1517b002662e4aa030c83f497fceb19f_254920_480x0_resize_lanczos_2.png 480w, /blog/2018/06/example-query1_hu1517b002662e4aa030c83f497fceb19f_254920_768x0_resize_lanczos_2.png 768w, /blog/2018/06/example-query1_hu1517b002662e4aa030c83f497fceb19f_254920_1024x0_resize_lanczos_2.png 1024w" src=/blog/2018/06/example-query1.png alt="example query1"></figure></p><h3 id=path-2-secondary-index>Path 2: Secondary Index</h3><p>So what if we choose a different path by using the ‚Äòschool‚Äô column index instead of the primary index? TiSpark will then go through a different procedure for secondary index.</p><p>A secondary index in TiKV is encoded like main table data. (For more detailed info on how TiKV encodes data, please see this <a href=https://pingcap.com/blog/2017-07-11-tidbinternal2/ target=_blank rel="noopener noreferrer">post</a>.) The difference is the split / sort key is not on primary key but on the index keys, and primary key is attached at the end for each index entry.</p><p>TiSpark reads all index entries per value range ‚Äúschool = ‚Äòengineering‚Äô‚Äù to retrieve all primary keys in the way illustrated below. We don‚Äôt directly search the main table via primary keys retrieved. Instead, we do a shuffle by regionID for each primary key, and then in each of the executor, TiSpark merges all the keys into continuous range. By doing so, TiSpark transforms point queries into range queries and improves performance. If there are cases where primary keys are sparse and scattered, then for that specific region, the system automatically adapts by downgrading a coprocessor request to a region scan to avoid performance hit.</p><p><figure><img sizes=100vw srcset="/blog/2018/06/query1-explained_hu33e246a8a0fd6e0be3530520af22166b_202056_480x0_resize_lanczos_2.png 480w, /blog/2018/06/query1-explained_hu33e246a8a0fd6e0be3530520af22166b_202056_768x0_resize_lanczos_2.png 768w, /blog/2018/06/query1-explained_hu33e246a8a0fd6e0be3530520af22166b_202056_1024x0_resize_lanczos_2.png 1024w" src=/blog/2018/06/query1-explained.png alt="query1 explained"></figure></p><h3 id=so-which-path-does-tispark-choose>So Which Path Does TiSpark Choose?</h3><p>TiSpark relies on a histogram built within TiDB to estimate cost and pick which path is the best way forward. Histogram is a common technique supported and applied in many relational databases. Consider TiDB‚Äôs histogram bar chart on column values below. The width of the bar is the value ranges for a specific column and height is the row count for that range. For predicates that matches an index, TiSpark estimates the total row to be returned if we apply it, but row count is not the cost. We introduced two different approaches to access a table, primary index or secondary index, and in this case the former one is far cheaper since it reads the table just once and always via sequential scan. In this scenario, even if ‚ÄòstudentId‚Äô predicate returns 200 more rows than ‚Äòschool‚Äô column predicate, TiSpark would pick primary index as the better path.</p><p><figure><img sizes=100vw srcset="/blog/2018/06/tspark-query-path_hu0efb144fef14b6a11e85d71e26a11e71_184964_480x0_resize_lanczos_2.png 480w, /blog/2018/06/tspark-query-path_hu0efb144fef14b6a11e85d71e26a11e71_184964_768x0_resize_lanczos_2.png 768w, /blog/2018/06/tspark-query-path_hu0efb144fef14b6a11e85d71e26a11e71_184964_1024x0_resize_lanczos_2.png 1024w" src=/blog/2018/06/tspark-query-path.png alt="TiSpark query path selection"></figure></p><h3 id=aggregation-pushdown>Aggregation Pushdown</h3><p>Another optimization we‚Äôve implemented is aggregation pushdown. TiSpark will rewrite the aggregation plan and push down the partial aggregation to the coprocessor, if possible. This only happens if the underlying predicates and enclosed expression are all computable by the coprocessor. Coprocessor then calculates the aggregations for each of the region involved and typically returns less row to TiSpark as results, thus reducing the cost of serialization.</p><p><figure><img sizes=100vw srcset="/blog/2018/06/tispark-aggregation-pushdown_hu320cc17df096100192329e4b7907f1f3_269253_480x0_resize_lanczos_2.png 480w, /blog/2018/06/tispark-aggregation-pushdown_hu320cc17df096100192329e4b7907f1f3_269253_768x0_resize_lanczos_2.png 768w, /blog/2018/06/tispark-aggregation-pushdown_hu320cc17df096100192329e4b7907f1f3_269253_1024x0_resize_lanczos_2.png 1024w" src=/blog/2018/06/tispark-aggregation-pushdown.png alt="TiSpark aggregation pushdown"></figure></p><h2 id=why-use-tispark>Why Use TiSpark?</h2><p>Because TiDB as a whole is a distributed NewSQL database, storing data sizes that are far larger than what can be stored in a single machine, it‚Äôs natural to layer a distributed compute engine like Spark on top of it. Without TiSpark, you would need do things the old way: do a daily dump of all your data into a Hadoop/Hive cluster or another data warehouse before you can analyze it&ndash;a situation many of our customers like <a href=https://www.pingcap.com/blog/Use-Case-TiDB-in-Mobike/ target=_blank rel="noopener noreferrer">Mobike</a> avoided by adopting TiDB with TiSpark. If you want to run queries on ‚Äúfresh‚Äù data, not stale ones that are at least one day old, then TiSpark shines. Plus, you no longer need to manage and maintain any ETL pipelines, saving your team lots of time, resources, and headaches.</p><h2 id=whats-next>What‚Äôs Next?</h2><p>Although we released TiSpark 1.0 not that long ago, we are already busy working on new features. Here is a list of the important features we‚Äôd like to build in 2018:</p><ul><li>Compatibility with Spark 2.3 (right now TiSpark supports 2.1)</li><li>Batch Write Support (writing directly in TiKV native format)</li><li>JSON Type support (since TiDB already supports JSON as well)</li><li>Partition Table support (both Range and Hash)</li><li>Join optimization based on range and partition table</li></ul><p>If you are interested in helping us build any of these features, please <a href=https://github.com/pingcap/tispark target=_blank rel="noopener noreferrer">contribute</a>! TiSpark is open-sourced.</p><h2 id=try-it-out>Try it Out!</h2><p>Lastly, seeing is believing. You can easily try out the TiDB + TiSpark combo by following a <a href=https://www.pingcap.com/blog/how_to_spin_up_an_htap_database_in_5_minutes_with_tidb_tispark/ target=_blank rel="noopener noreferrer">5-minute tutorial</a> our team recently put together, to spin up a cluster on your laptop using Docker-Compose. If you want to deploy this HTAP solution in a production environment, please <a href=https://pingcap.com/contact-us/ target=_blank rel="noopener noreferrer">contact us</a>, and our team would be happy to help you!</p><h3 id=about-the-author>About the Author</h3><p><strong>Shawn Ma</strong> is a Tech Lead at PingCAP and TiSpark team lead. Previously, he was an infrastructure engineer at Netease and Quantcast. He received his Masters in Computer Science from University of California-Irvine. <span aria-label="End of article." role=text class=tombstone>‚àé</span></p></div></article></div></main><footer class=page><h1 class=aria-only id=footer-heading aria-hidden=false>Footer</h1><div class=page-footer><nav class=footer><ul><li><a href=https://www.percona.com/about-percona target=_blank rel="noopener noreferrer"><span>About</span></a></li><li><a href=https://www.percona.com/legal target=_blank rel="noopener noreferrer"><span>Legal</span></a></li><li><a href=https://forums.percona.com/ target=_blank rel="noopener noreferrer"><span>Forums</span></a></li><li><a href=https://www.percona.com/about-percona/contact target=_blank rel="noopener noreferrer"><span>Contact</span></a></li></ul></nav></div><aside>¬© Percona Community. MySQL, InnoDB, MariaDB and MongoDB are trademarks of their respective owners.</aside></footer><script type=text/javascript src=https://percona.community/js/aria.5f30892348d4662fe548bb410f15fc6fe2e1cbfd6473beb3c3ed1d6b362568bbea48896a9f2302a4f78f4614904ca3ef43155ae26f063ed84ae957f951e19647.js integrity="sha512-XzCJI0jUZi/lSLtBDxX8b+Lhy/1kc76zw+0dazYlaLvqSIlqnyMCpPePRhSQTKPvQxVa4m8GPthK6Vf5UeGWRw==" defer></script></body></html>