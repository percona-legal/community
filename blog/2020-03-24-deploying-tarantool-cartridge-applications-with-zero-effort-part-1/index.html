<!doctype html><html lang=en prefix="og: https://ogp.me/ns#"><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,minimum-scale=1"><title>Deploying Tarantool Cartridge Applications with Zero Effort (Part 1) | Percona Community</title><meta name=description content="Tarantool is an open-source in-memory DB with a Lua application server on board. It&rsquo;s best used for apps that require high performance and horizontal scaling. Out of the box we support horizontal scaling via the vshard module. There are quite a few things that you have to keep in mind when you work on your business logic, though. Not ideal.
We made it easier. All the lessons learned from creating distributed apps resulted in a framework called Tarantool Cartridge."><link rel=canonical href=https://percona.community/blog/2020-03-24-deploying-tarantool-cartridge-applications-with-zero-effort-part-1/><meta name=robots content="noindex,nofollow"><meta property="og:title" content="Deploying Tarantool Cartridge Applications with Zero Effort (Part 1)"><meta property="og:description" content="Tarantool is an open-source in-memory DB with a Lua application server on board. It&rsquo;s best used for apps that require high performance and horizontal scaling. Out of the box we support horizontal scaling via the vshard module. There are quite a few things that you have to keep in mind when you work on your business logic, though. Not ideal.
We made it easier. All the lessons learned from creating distributed apps resulted in a framework called Tarantool Cartridge."><meta property="og:type" content="article"><meta property="og:url" content="https://percona.community/blog/2020-03-24-deploying-tarantool-cartridge-applications-with-zero-effort-part-1/"><meta name=image property="og:image" content="https://percona.community/blog/2020/02/tarantool-new-instances-scaled_huf1c0a5ad0843880587f62ac055c091c8_1471416_1200x0_resize_q90_bgffffff_lanczos_2.jpg"><meta property="article:published_time" content="2020-03-24T14:04:32+00:00"><meta property="article:modified_time" content="2020-03-24T14:04:32+00:00"><meta property="article:section" content="blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://percona.community/blog/2020/02/tarantool-new-instances-scaled.png"><meta name=twitter:title content="Deploying Tarantool Cartridge Applications with Zero Effort (Part 1) | Percona Community"><meta name=twitter:description content="Tarantool is an open-source in-memory DB with a Lua application server on board. It&rsquo;s best used for apps that require high performance and horizontal scaling. Out of the box we support horizontal scaling via the vshard module. There are quite a few things that you have to keep in mind when you work on your business logic, though. Not ideal.
We made it easier. All the lessons learned from creating distributed apps resulted in a framework called Tarantool Cartridge."><meta name=twitter:site content="@Percona"><meta name=description content="Tarantool is an open-source in-memory DB with a Lua application server on board. It&rsquo;s best used for apps that require high performance and horizontal scaling. Out of the box we support horizontal scaling via the vshard module. There are quite a few things that you have to keep in mind when you work on your business logic, though. Not ideal.
We made it easier. All the lessons learned from creating distributed apps resulted in a framework called Tarantool Cartridge."><meta name=copyright content="© Percona Community. MySQL, InnoDB, MariaDB and MongoDB are trademarks of their respective owners.
"><meta name=author content="Elizaveta Dokshina"><style>@charset "UTF-8";html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;vertical-align:baseline}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after{content:none}q:before,q:after{content:none}table{border-collapse:collapse;border-spacing:0}html,body{font-family:Arial,sans-serif;scroll-behavior:smooth;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;line-height:1.5rem;font-feature-settings:"liga" 1;font-weight:500;font-size:18px}@media(min-width:900px){html,body{font-size:20px}}@media(min-width:1100px){html,body{font-size:22px}}@media(min-width:1800px){html,body{font-size:24px}}@media print{html,body{font-size:18px}}hr{border:0;height:2px;background-color:#fe7f2d;margin-top:1.5rem;margin-bottom:1.5rem}.text{position:relative}.text .meta{font-variant:small-caps}.text .meta .byline{display:none}.text .meta .line{display:inline-block}.text .meta .calendar{display:none}.text h1,.text h2,.text h3,.text h4,.text h5,.text h6{font-family:Georgia,palatino linotype,book antiqua,Palatino,times new roman,serif;font-weight:500;page-break-after:avoid}.text h1 a,.text h1 a:visited,.text h2 a,.text h2 a:visited,.text h3 a,.text h3 a:visited,.text h4 a,.text h4 a:visited,.text h5 a,.text h5 a:visited,.text h6 a,.text h6 a:visited{color:#2a2d34;text-decoration:none}.text p,.text ul,.text ol,.text figure,.text dl,.text hr{margin-top:1.5rem;font-size:1rem}.text q{font-style:italic}.text ul ul{margin-top:0}.text p>code,.text ul>code,.text ol>code,.text dt>code,.text dd>code,.text li>code{color:#009b72}.text button{cursor:pointer;display:inline-block;box-sizing:border-box;border:.1rem solid #6761a8;height:1.5rem;padding-left:.75rem;padding-right:.75rem;border-radius:.2rem;transition:color .233s ease-in-out,background-color .233s ease-in-out}.text button:hover{color:#fff;background-color:#6761a8}.text audio{display:block;width:100%;height:1.5rem;outline:none}.text audio span{line-height:1.5rem}.text dl{overflow:auto;position:relative}.text dt{font-weight:700}.text dd{padding-left:2rem}.text dd+dt{margin-top:1.5rem}.text ul{list-style-type:disc;padding-left:1.5rem}.text ol{list-style-type:decimal;padding-left:1.5rem}.text p{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.text h1{font-size:2.5rem;font-weight:500;line-height:3rem;margin-top:1.5rem;margin-bottom:0}@media screen and (min-width:760px){.text h1{font-size:3.5rem;line-height:4.5rem;margin-top:1.5rem}}@media screen and (min-width:900px){.text h1{font-size:4rem;line-height:4.5rem;margin-top:3rem}}@media screen and (min-width:1400px){.text h1{font-size:5rem;line-height:6rem;margin-top:6rem}}.text h2{font-size:2rem;line-height:3rem;margin-top:3rem;margin-bottom:3rem}.text h3{font-size:1.5rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h4{font-size:1rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h5{font-size:.8rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h6{font-size:.6rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text strong{font-weight:700}.text em{font-style:italic}.text blockquote{border-left:.2rem solid #999;padding-left:.75rem}.text code{font-family:lucida console,Monaco,monospace;speak:literal-punctuation}.text abbr,.text acronym{speak:spell-out}.text del{text-decoration:line-through}.text ins{text-decoration:none;font-style:italic}.text figure{position:relative;text-align:center}.text figure img{background:#fff;border-radius:.2rem;max-width:100%}.text figure table{min-width:75%;border-radius:.2rem;margin-left:auto;margin-right:auto;border:#6761a8;border-collapse:separate;border-spacing:0;background:#fff;margin-bottom:-.1em}.text figure table th,.text figure table td{padding-left:.75rem;padding-right:.75rem;line-height:1.3rem;border-left:.1rem solid #6761a8;border-top:.1rem solid #6761a8}.text figure table thead{background-color:#fff}.text figure table tr td:last-child,.text figure table tr th:last-child{border-right:.1rem solid #6761a8}.text figure table tbody:last-child tr:last-child td{border-bottom:.1rem solid #6761a8}.text figure table thead:first-child tr:first-child th:first-child,.text figure table thead:first-child tr:first-child td:first-child{border-top-left-radius:.2rem}.text figure table thead:first-child tr:first-child,.text figure table thead:first-child tr:first-child th:last-child,.text figure table thead:first-child tr:first-child td:last-child{border-top-right-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:first-child{border-bottom-left-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:last-child{border-bottom-right-radius:.2rem}.text figure ul{text-align:left}.text figure ul.tree{padding-top:1.5em;padding-bottom:1.5em;border-radius:.2rem;background:#fff}.text figure ul.tree li{list-style-type:none}.text figure ul.tree .tree__item--folder::before{content:"📁";margin-right:.2em}.text figure ul.tree .tree__item--file::before{content:"📝";margin-right:.2em}.text figure figcaption{font-style:italic}.text pre{margin-top:1.5rem;font-size:inherit;line-height:1.5rem;padding:1.5rem 1.5rem .75rem;white-space:pre;overflow-x:scroll;overflow-y:hidden;scrollbar-color:#cccccc transparent;scrollbar-width:.75rem}.text pre::-webkit-scrollbar{margin-top:-.75rem;height:.75rem}.text pre::-webkit-scrollbar-track{background:0 0}.text pre::-webkit-scrollbar-thumb{height:.1rem;border-radius:.2rem;background:#ccc}.text hr{border:0;height:.2rem;background:#6761a8;margin-top:1.3rem}.text .admonition{position:relative}.text .admonition>*{padding-left:2rem}.text .admonition>:first-child::before{display:block;text-align:left;position:absolute;top:0;left:0;width:.75rem;font-size:1rem;line-height:1.5rem;height:1.5rem}.text .admonition--tip>:first-child::before{content:"☛";color:#00a000;font-size:1.5rem;line-height:1.5rem;height:1.5rem}.text .admonition--warning>:first-child::before{content:"⚠️";color:#fe7f2d}.text .admonition--info>:first-child::before{content:"ⓘ";color:#004966;font-weight:700}@media print{.text h1{margin-left:auto;margin-right:auto;margin-top:9rem;width:80%;font-variant:small-caps;text-align:center}.text--simple h1{margin-top:0}.text .meta{page-break-after:always;text-align:center;font-size:1.2rem;margin-top:1.5rem}.text .meta a{text-decoration:none}.text .meta time{display:none}.text .body p:first-of-type{margin-top:0}.text pre{padding:0;font-size:inherit;line-height:1.5rem;overflow:hidden;white-space:pre-wrap;word-break:break-all}}.text .podcasts{margin-top:1.5rem;text-align:center}.text a.podcast{display:block;height:3rem}.text a.podcast img{width:50%;max-width:200px}@media screen and (min-width:768px){.text .podcasts{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));grid-gap:1.5rem}.text a.podcast img{width:100%}}.text .tombstone{opacity:0}html,body{min-height:100vh}body{text-align:center}@media screen{body{color:#2a2d34;background-color:#fefefe}}@media print{body{color:#000;background:#fff}}@media screen{body{display:flex;flex-direction:column}main.page{width:100%;flex:1}}header.page,main.page,footer.page{text-align:left}.page-main,.contentblock{max-width:1400px;padding-left:1.5rem;padding-right:1.5rem;margin-left:auto;margin-right:auto}@media print{.page-main,.contentblock{padding:0}}@page{size:A4;padding:0;margin:3rem}.highlight{color:#6761a8}.nobr{white-space:nowrap}.aria-only{display:none}@media aural{.aria-only{display:block}}a{color:#004966;text-decoration-color:#a2dffb;transition:color .233s ease-out,text-decoration-color .233s ease-out}a:hover,a:visited:hover{color:#fe7f2d}a:active{color:#fe7f2d}a:visited{color:#6761a8;text-decoration-color:#009b72}html,body{font-family:Arial,sans-serif;scroll-behavior:smooth;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;line-height:1.5rem;font-feature-settings:"liga" 1;font-weight:500;font-size:18px}@media(min-width:900px){html,body{font-size:20px}}@media(min-width:1100px){html,body{font-size:22px}}@media(min-width:1800px){html,body{font-size:24px}}@media print{html,body{font-size:18px}}hr{border:0;height:2px;background-color:#fe7f2d;margin-top:1.5rem;margin-bottom:1.5rem}.text{position:relative}.text .meta{font-variant:small-caps}.text .meta .byline{display:none}.text .meta .line{display:inline-block}.text .meta .calendar{display:none}.text h1,.text h2,.text h3,.text h4,.text h5,.text h6{font-family:Georgia,palatino linotype,book antiqua,Palatino,times new roman,serif;font-weight:500;page-break-after:avoid}.text h1 a,.text h1 a:visited,.text h2 a,.text h2 a:visited,.text h3 a,.text h3 a:visited,.text h4 a,.text h4 a:visited,.text h5 a,.text h5 a:visited,.text h6 a,.text h6 a:visited{color:#2a2d34;text-decoration:none}.text p,.text ul,.text ol,.text figure,.text dl,.text hr{margin-top:1.5rem;font-size:1rem}.text q{font-style:italic}.text ul ul{margin-top:0}.text p>code,.text ul>code,.text ol>code,.text dt>code,.text dd>code,.text li>code{color:#009b72}.text button{cursor:pointer;display:inline-block;box-sizing:border-box;border:.1rem solid #6761a8;height:1.5rem;padding-left:.75rem;padding-right:.75rem;border-radius:.2rem;transition:color .233s ease-in-out,background-color .233s ease-in-out}.text button:hover{color:#fff;background-color:#6761a8}.text audio{display:block;width:100%;height:1.5rem;outline:none}.text audio span{line-height:1.5rem}.text dl{overflow:auto;position:relative}.text dt{font-weight:700}.text dd{padding-left:2rem}.text dd+dt{margin-top:1.5rem}.text ul{list-style-type:disc;padding-left:1.5rem}.text ol{list-style-type:decimal;padding-left:1.5rem}.text p{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.text h1{font-size:2.5rem;font-weight:500;line-height:3rem;margin-top:1.5rem;margin-bottom:0}@media screen and (min-width:760px){.text h1{font-size:3.5rem;line-height:4.5rem;margin-top:1.5rem}}@media screen and (min-width:900px){.text h1{font-size:4rem;line-height:4.5rem;margin-top:3rem}}@media screen and (min-width:1400px){.text h1{font-size:5rem;line-height:6rem;margin-top:6rem}}.text h2{font-size:2rem;line-height:3rem;margin-top:3rem;margin-bottom:3rem}.text h3{font-size:1.5rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h4{font-size:1rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h5{font-size:.8rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h6{font-size:.6rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text strong{font-weight:700}.text em{font-style:italic}.text blockquote{border-left:.2rem solid #999;padding-left:.75rem}.text code{font-family:lucida console,Monaco,monospace;speak:literal-punctuation}.text abbr,.text acronym{speak:spell-out}.text del{text-decoration:line-through}.text ins{text-decoration:none;font-style:italic}.text figure{position:relative;text-align:center}.text figure img{background:#fff;border-radius:.2rem;max-width:100%}.text figure table{min-width:75%;border-radius:.2rem;margin-left:auto;margin-right:auto;border:#6761a8;border-collapse:separate;border-spacing:0;background:#fff;margin-bottom:-.1em}.text figure table th,.text figure table td{padding-left:.75rem;padding-right:.75rem;line-height:1.3rem;border-left:.1rem solid #6761a8;border-top:.1rem solid #6761a8}.text figure table thead{background-color:#fff}.text figure table tr td:last-child,.text figure table tr th:last-child{border-right:.1rem solid #6761a8}.text figure table tbody:last-child tr:last-child td{border-bottom:.1rem solid #6761a8}.text figure table thead:first-child tr:first-child th:first-child,.text figure table thead:first-child tr:first-child td:first-child{border-top-left-radius:.2rem}.text figure table thead:first-child tr:first-child,.text figure table thead:first-child tr:first-child th:last-child,.text figure table thead:first-child tr:first-child td:last-child{border-top-right-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:first-child{border-bottom-left-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:last-child{border-bottom-right-radius:.2rem}.text figure ul{text-align:left}.text figure ul.tree{padding-top:1.5em;padding-bottom:1.5em;border-radius:.2rem;background:#fff}.text figure ul.tree li{list-style-type:none}.text figure ul.tree .tree__item--folder::before{content:"📁";margin-right:.2em}.text figure ul.tree .tree__item--file::before{content:"📝";margin-right:.2em}.text figure figcaption{font-style:italic}.text pre{margin-top:1.5rem;font-size:inherit;line-height:1.5rem;padding:1.5rem 1.5rem .75rem;white-space:pre;overflow-x:scroll;overflow-y:hidden;scrollbar-color:#cccccc transparent;scrollbar-width:.75rem}.text pre::-webkit-scrollbar{margin-top:-.75rem;height:.75rem}.text pre::-webkit-scrollbar-track{background:0 0}.text pre::-webkit-scrollbar-thumb{height:.1rem;border-radius:.2rem;background:#ccc}.text hr{border:0;height:.2rem;background:#6761a8;margin-top:1.3rem}.text .admonition{position:relative}.text .admonition>*{padding-left:2rem}.text .admonition>:first-child::before{display:block;text-align:left;position:absolute;top:0;left:0;width:.75rem;font-size:1rem;line-height:1.5rem;height:1.5rem}.text .admonition--tip>:first-child::before{content:"☛";color:#00a000;font-size:1.5rem;line-height:1.5rem;height:1.5rem}.text .admonition--warning>:first-child::before{content:"⚠️";color:#fe7f2d}.text .admonition--info>:first-child::before{content:"ⓘ";color:#004966;font-weight:700}@media print{.text h1{margin-left:auto;margin-right:auto;margin-top:9rem;width:80%;font-variant:small-caps;text-align:center}.text--simple h1{margin-top:0}.text .meta{page-break-after:always;text-align:center;font-size:1.2rem;margin-top:1.5rem}.text .meta a{text-decoration:none}.text .meta time{display:none}.text .body p:first-of-type{margin-top:0}.text pre{padding:0;font-size:inherit;line-height:1.5rem;overflow:hidden;white-space:pre-wrap;word-break:break-all}}.text .podcasts{margin-top:1.5rem;text-align:center}.text a.podcast{display:block;height:3rem}.text a.podcast img{width:50%;max-width:200px}@media screen and (min-width:768px){.text .podcasts{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));grid-gap:1.5rem}.text a.podcast img{width:100%}}.text .tombstone{opacity:0}.page-header a{display:block;text-decoration:none;height:2.6rem;line-height:2.6rem;border-top:.2rem solid transparent;border-bottom:.2rem solid transparent}.page-header a,.page-header a span{transition:color .233s ease-in-out,border-bottom .233s,margin-bottom .233s}.page-header a:hover{color:#004966;border-bottom:.2rem solid #004966}.page-header a:hover span{color:#004966}.page-header a img{height:2.6rem}.page-header a{color:#2a2d34;border-bottom:0 solid #fefefe}.page-header a:hover{color:#004966;border-bottom-color:#004966}.page-header a:visited{color:#2a2d34}.page-header a{display:block;border-bottom-width:0;font-weight:700}.page-header .logo{z-index:6;font-size:1.2rem;font-weight:700;font-variant:small-caps}.page-header .logo a{margin-top:.2rem;text-decoration:none;display:block;border:none}#show-mobile-menu{display:none}.mobile-toggle{display:none}@media screen and (max-width:759px){header.page{box-shadow:0 0 3px rgba(168,168,168,.5)}.logo a{position:absolute}.page-header{justify-content:space-between;z-index:1}.hamburger-bar{height:.2rem;background:#2a2d34;margin-top:.2rem;display:block}#show-mobile-menu+.mobile-toggle+.mobile-menu nav{background:#fefefe}#show-mobile-menu+.mobile-toggle .hamburger-bar{transform:translateY(0)rotate(0);opacity:1;transition:transform .233s ease-in-out,opacity .233s ease-in-out}#show-mobile-menu:checked+.mobile-toggle{position:fixed;right:1.5rem}#show-mobile-menu:checked+.mobile-toggle .hamburger-bar:nth-of-type(1){transform:translateY(.4rem)rotate(315deg)}#show-mobile-menu:checked+.mobile-toggle .hamburger-bar:nth-of-type(2){opacity:0}#show-mobile-menu:checked+.mobile-toggle .hamburger-bar:nth-of-type(3){transform:translateY(-.4rem)rotate(405deg)}.mobile-toggle{cursor:pointer;display:block;width:1.2rem;height:1rem;z-index:5;margin-top:.75rem}.mobile-toggle label,.mobile-toggle .hamburger-bar{cursor:pointer}.mobile-menu{overflow:hidden;position:fixed;top:0;left:0;right:0;bottom:100vh;opacity:0;background:rgba(0,0,0,.5);transition:opacity .233s ease-in-out,bottom .233s ease-in-out}#show-mobile-menu:checked+.mobile-toggle+.mobile-menu{opacity:1;bottom:0}.hide-mobile-menu{display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:2}.mobile-menu nav{box-sizing:border-box;max-height:100%;position:absolute;top:0;left:0;right:0;z-index:3;font-size:1rem;line-height:3rem;padding:3rem 1.5rem 1.5rem;display:flex;flex-direction:column}.mobile-menu nav header{display:flex;flex-direction:row;font-size:inherit;line-height:inherit}.mobile-menu nav header h1{margin-top:0;font-size:1.2rem;line-height:1.5rem;flex:1;font-variant:small-caps}.mobile-menu nav header .hide-mobile-menu-aria{display:block;z-index:10;height:1.5rem;width:1.5rem}.mobile-menu nav ul{overflow-y:scroll;flex:1;scrollbar-width:none;-ms-overflow-style:none}.mobile-menu nav ul::-webkit-scrollbar{width:0;background:0 0}.mobile-menu nav a:hover{border-bottom:0;margin-bottom:0}}@media screen and (min-width:760px){.page-header .mobile-toggle{display:none}.page-header .mobile-menu{flex:1}.page-header nav{flex:1}.page-header nav header{display:none}.page-header ul{list-style-type:none}.page-header nav ul{display:flex;align-items:end;justify-content:flex-end;flex-direction:row}.page-header nav li{padding-left:1.5rem}.page-header nav li.active a{border-bottom-width:3px;border-bottom-color:#6761a8}}@media screen{.page-header{position:relative;max-width:1400px;margin-left:auto;margin-right:auto;padding-left:1.5rem;padding-right:1.5rem;height:3rem;display:flex;flex-direction:row}}@media print{header.page{display:none}}@media screen and (max-width:759px) and (prefers-reduced-motion:reduce){.mobile-menu{transition:none}#show-mobile-menu+.mobile-toggle .hamburger-bar{transition:none}}@media screen and (max-width:759px) and (prefers-reduced-transparency:reduce){.mobile-menu{background:gray}}html,body{font-family:Arial,sans-serif;scroll-behavior:smooth;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;line-height:1.5rem;font-feature-settings:"liga" 1;font-weight:500;font-size:18px}@media(min-width:900px){html,body{font-size:20px}}@media(min-width:1100px){html,body{font-size:22px}}@media(min-width:1800px){html,body{font-size:24px}}@media print{html,body{font-size:18px}}hr{border:0;height:2px;background-color:#fe7f2d;margin-top:1.5rem;margin-bottom:1.5rem}.text{position:relative}.text .meta{font-variant:small-caps}.text .meta .byline{display:none}.text .meta .line{display:inline-block}.text .meta .calendar{display:none}.text h1,.text h2,.text h3,.text h4,.text h5,.text h6{font-family:Georgia,palatino linotype,book antiqua,Palatino,times new roman,serif;font-weight:500;page-break-after:avoid}.text h1 a,.text h1 a:visited,.text h2 a,.text h2 a:visited,.text h3 a,.text h3 a:visited,.text h4 a,.text h4 a:visited,.text h5 a,.text h5 a:visited,.text h6 a,.text h6 a:visited{color:#2a2d34;text-decoration:none}.text p,.text ul,.text ol,.text figure,.text dl,.text hr{margin-top:1.5rem;font-size:1rem}.text q{font-style:italic}.text ul ul{margin-top:0}.text p>code,.text ul>code,.text ol>code,.text dt>code,.text dd>code,.text li>code{color:#009b72}.text button{cursor:pointer;display:inline-block;box-sizing:border-box;border:.1rem solid #6761a8;height:1.5rem;padding-left:.75rem;padding-right:.75rem;border-radius:.2rem;transition:color .233s ease-in-out,background-color .233s ease-in-out}.text button:hover{color:#fff;background-color:#6761a8}.text audio{display:block;width:100%;height:1.5rem;outline:none}.text audio span{line-height:1.5rem}.text dl{overflow:auto;position:relative}.text dt{font-weight:700}.text dd{padding-left:2rem}.text dd+dt{margin-top:1.5rem}.text ul{list-style-type:disc;padding-left:1.5rem}.text ol{list-style-type:decimal;padding-left:1.5rem}.text p{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.text h1{font-size:2.5rem;font-weight:500;line-height:3rem;margin-top:1.5rem;margin-bottom:0}@media screen and (min-width:760px){.text h1{font-size:3.5rem;line-height:4.5rem;margin-top:1.5rem}}@media screen and (min-width:900px){.text h1{font-size:4rem;line-height:4.5rem;margin-top:3rem}}@media screen and (min-width:1400px){.text h1{font-size:5rem;line-height:6rem;margin-top:6rem}}.text h2{font-size:2rem;line-height:3rem;margin-top:3rem;margin-bottom:3rem}.text h3{font-size:1.5rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h4{font-size:1rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h5{font-size:.8rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h6{font-size:.6rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text strong{font-weight:700}.text em{font-style:italic}.text blockquote{border-left:.2rem solid #999;padding-left:.75rem}.text code{font-family:lucida console,Monaco,monospace;speak:literal-punctuation}.text abbr,.text acronym{speak:spell-out}.text del{text-decoration:line-through}.text ins{text-decoration:none;font-style:italic}.text figure{position:relative;text-align:center}.text figure img{background:#fff;border-radius:.2rem;max-width:100%}.text figure table{min-width:75%;border-radius:.2rem;margin-left:auto;margin-right:auto;border:#6761a8;border-collapse:separate;border-spacing:0;background:#fff;margin-bottom:-.1em}.text figure table th,.text figure table td{padding-left:.75rem;padding-right:.75rem;line-height:1.3rem;border-left:.1rem solid #6761a8;border-top:.1rem solid #6761a8}.text figure table thead{background-color:#fff}.text figure table tr td:last-child,.text figure table tr th:last-child{border-right:.1rem solid #6761a8}.text figure table tbody:last-child tr:last-child td{border-bottom:.1rem solid #6761a8}.text figure table thead:first-child tr:first-child th:first-child,.text figure table thead:first-child tr:first-child td:first-child{border-top-left-radius:.2rem}.text figure table thead:first-child tr:first-child,.text figure table thead:first-child tr:first-child th:last-child,.text figure table thead:first-child tr:first-child td:last-child{border-top-right-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:first-child{border-bottom-left-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:last-child{border-bottom-right-radius:.2rem}.text figure ul{text-align:left}.text figure ul.tree{padding-top:1.5em;padding-bottom:1.5em;border-radius:.2rem;background:#fff}.text figure ul.tree li{list-style-type:none}.text figure ul.tree .tree__item--folder::before{content:"📁";margin-right:.2em}.text figure ul.tree .tree__item--file::before{content:"📝";margin-right:.2em}.text figure figcaption{font-style:italic}.text pre{margin-top:1.5rem;font-size:inherit;line-height:1.5rem;padding:1.5rem 1.5rem .75rem;white-space:pre;overflow-x:scroll;overflow-y:hidden;scrollbar-color:#cccccc transparent;scrollbar-width:.75rem}.text pre::-webkit-scrollbar{margin-top:-.75rem;height:.75rem}.text pre::-webkit-scrollbar-track{background:0 0}.text pre::-webkit-scrollbar-thumb{height:.1rem;border-radius:.2rem;background:#ccc}.text hr{border:0;height:.2rem;background:#6761a8;margin-top:1.3rem}.text .admonition{position:relative}.text .admonition>*{padding-left:2rem}.text .admonition>:first-child::before{display:block;text-align:left;position:absolute;top:0;left:0;width:.75rem;font-size:1rem;line-height:1.5rem;height:1.5rem}.text .admonition--tip>:first-child::before{content:"☛";color:#00a000;font-size:1.5rem;line-height:1.5rem;height:1.5rem}.text .admonition--warning>:first-child::before{content:"⚠️";color:#fe7f2d}.text .admonition--info>:first-child::before{content:"ⓘ";color:#004966;font-weight:700}@media print{.text h1{margin-left:auto;margin-right:auto;margin-top:9rem;width:80%;font-variant:small-caps;text-align:center}.text--simple h1{margin-top:0}.text .meta{page-break-after:always;text-align:center;font-size:1.2rem;margin-top:1.5rem}.text .meta a{text-decoration:none}.text .meta time{display:none}.text .body p:first-of-type{margin-top:0}.text pre{padding:0;font-size:inherit;line-height:1.5rem;overflow:hidden;white-space:pre-wrap;word-break:break-all}}.text .podcasts{margin-top:1.5rem;text-align:center}.text a.podcast{display:block;height:3rem}.text a.podcast img{width:50%;max-width:200px}@media screen and (min-width:768px){.text .podcasts{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));grid-gap:1.5rem}.text a.podcast img{width:100%}}.text .tombstone{opacity:0}html,body{min-height:100vh}body{text-align:center}@media screen{body{color:#2a2d34;background-color:#fefefe}}@media print{body{color:#000;background:#fff}}@media screen{body{display:flex;flex-direction:column}main.page{width:100%;flex:1}}header.page,main.page,footer.page{text-align:left}.page-main,.contentblock{max-width:1400px;padding-left:1.5rem;padding-right:1.5rem;margin-left:auto;margin-right:auto}@media print{.page-main,.contentblock{padding:0}}@page{size:A4;padding:0;margin:3rem}.highlight{color:#6761a8}.nobr{white-space:nowrap}.aria-only{display:none}@media aural{.aria-only{display:block}}a{color:#004966;text-decoration-color:#a2dffb;transition:color .233s ease-out,text-decoration-color .233s ease-out}a:hover,a:visited:hover{color:#fe7f2d}a:active{color:#fe7f2d}a:visited{color:#6761a8;text-decoration-color:#009b72}footer.page{margin-top:1.5rem}footer.page h2{font-size:1rem}@media not print{footer.page{margin-top:1.5rem/2;padding-top:1.5rem/2;padding-bottom:1.5rem/2}.page-footer{max-width:1400px;padding-left:1.5rem;padding-right:1.5rem;margin-left:auto;margin-right:auto;font-size:.7rem;line-height:1.5rem}}@media not print{.page-footer ul{margin-bottom:1.5rem}.page-footer a{display:block;text-decoration:none;height:2.6rem;line-height:2.6rem;border-top:.2rem solid transparent;border-bottom:.2rem solid transparent}.page-footer a,.page-footer a span{transition:color .233s ease-in-out,border-bottom .233s,margin-bottom .233s}.page-footer a:hover{color:#004966;border-bottom:.2rem solid #004966}.page-footer a:hover span{color:#004966}.page-footer a img{height:2.6rem}.page-footer nav ul{display:flex;flex-direction:row;align-items:center;justify-content:center;margin-bottom:0;height:1.5rem;line-height:1.5rem}.page-footer nav ul a{height:1.3rem;line-height:1.3rem;text-align:center;display:block;padding-left:.75rem;padding-right:.75rem;border-bottom:.2rem solid transparent}}@media print{footer.page nav{display:none}footer.page aside{border-top:.2rem solid #333;margin-top:.65rem;padding-top:.65rem}}footer.page{border-top:2px solid #fe7f2d;margin-top:-2px}footer.page aside{text-align:center;font-size:.6rem;line-height:1.5rem;color:#333}@media screen{footer.page{background-color:#fefefe}.page-footer a{color:#2a2d34;border-bottom:0 solid #fefefe}.page-footer a:hover{color:#004966;border-bottom-color:#004966}.page-footer a:visited{color:#2a2d34}}.grid{display:grid;gap:1.5rem 1.5rem;font-size:.9rem;margin-bottom:1.5rem;margin-top:1.5rem}.grid--2{grid-template-columns:1fr 1fr}.grid--3{grid-template-columns:1fr 1fr 1fr}.grid--4{grid-template-columns:1fr 1fr 1fr}.grid img{max-width:100%}.grid h2{font-size:1.2rem;margin-bottom:.75rem}.grid p{margin-bottom:.75rem}@media(max-width:768px){.grid--2{display:block}}@media(max-width:1200px){.grid--3{display:block}}@media(max-width:1600px){.grid--4{display:block}}.post--preview{display:block;border-radius:.3rem;padding-bottom:.375rem}.post--preview img{margin-bottom:.375rem}.post--preview h2,.post--preview p{padding-left:.5rem;padding-right:.5rem}.post--preview :last-child{margin-bottom:0}.post--preview:hover{box-shadow:0 0 1.5rem #666666}a.post--preview,a.post--preview *{text-decoration:none;color:#2a2d34}a.post--preview .readmore,a.post--preview * .readmore{font-weight:700}.hero{background-color:#004966;background-position:50%;background-repeat:no-repeat;background-size:cover;color:#fff}.hero h1{margin-bottom:1.5rem}.hero a{color:#fff;font-weight:700;border-bottom:2px solid #fff;text-decoration:none;transition:color .233s ease-out,border-bottom-color .233s ease-out}.hero a:hover,.hero a:visited:hover{color:#fff;border-bottom-color:#fe7f2d}.hero img{float:left;margin-right:1.5rem}.hero:nth-child(4n+2),.hero:nth-child(4n+4){background-color:initial;color:#2a2d34}.hero:nth-child(4n+2) img,.hero:nth-child(4n+4) img{float:right;margin-right:0;margin-left:1.5rem}.hero:nth-child(4n+2) a,.hero:nth-child(4n+4) a{color:#2a2d34}.hero:nth-child(4n+2) a:hover,.hero:nth-child(4n+4) a:hover{color:#2a2d34}.hero:nth-child(4n+3){background-color:#fe7f2d}.hero--bio .contentblock{text-align:center}.hero--bio .contentblock img{text-align:center;float:none;margin-bottom:1.5rem}.hero--bio .contentblock p{text-align:left}@media(min-width:769px){.hero--bio .contentblock{min-height:240px;text-align:left}.hero--bio .contentblock img{float:right;margin-left:1.5rem;margin-bottom:0}}.contentblock{padding-top:3rem;padding-bottom:3rem}.herotext{font-size:1.2rem;background:rgba(0,0,0,.5);padding:1.5rem;border-radius:.75rem}.herotext p{margin-top:1.5rem}.herotext p:first-child{margin-top:0}.herotext small{font-size:.8rem}html,body{font-family:Arial,sans-serif;scroll-behavior:smooth;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;line-height:1.5rem;font-feature-settings:"liga" 1;font-weight:500;font-size:18px}@media(min-width:900px){html,body{font-size:20px}}@media(min-width:1100px){html,body{font-size:22px}}@media(min-width:1800px){html,body{font-size:24px}}@media print{html,body{font-size:18px}}hr{border:0;height:2px;background-color:#fe7f2d;margin-top:1.5rem;margin-bottom:1.5rem}.text{position:relative}.text .meta{font-variant:small-caps}.text .meta .byline{display:none}.text .meta .line{display:inline-block}.text .meta .calendar{display:none}.text h1,.text h2,.text h3,.text h4,.text h5,.text h6{font-family:Georgia,palatino linotype,book antiqua,Palatino,times new roman,serif;font-weight:500;page-break-after:avoid}.text h1 a,.text h1 a:visited,.text h2 a,.text h2 a:visited,.text h3 a,.text h3 a:visited,.text h4 a,.text h4 a:visited,.text h5 a,.text h5 a:visited,.text h6 a,.text h6 a:visited{color:#2a2d34;text-decoration:none}.text p,.text ul,.text ol,.text figure,.text dl,.text hr{margin-top:1.5rem;font-size:1rem}.text q{font-style:italic}.text ul ul{margin-top:0}.text p>code,.text ul>code,.text ol>code,.text dt>code,.text dd>code,.text li>code{color:#009b72}.text button{cursor:pointer;display:inline-block;box-sizing:border-box;border:.1rem solid #6761a8;height:1.5rem;padding-left:.75rem;padding-right:.75rem;border-radius:.2rem;transition:color .233s ease-in-out,background-color .233s ease-in-out}.text button:hover{color:#fff;background-color:#6761a8}.text audio{display:block;width:100%;height:1.5rem;outline:none}.text audio span{line-height:1.5rem}.text dl{overflow:auto;position:relative}.text dt{font-weight:700}.text dd{padding-left:2rem}.text dd+dt{margin-top:1.5rem}.text ul{list-style-type:disc;padding-left:1.5rem}.text ol{list-style-type:decimal;padding-left:1.5rem}.text p{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.text h1{font-size:2.5rem;font-weight:500;line-height:3rem;margin-top:1.5rem;margin-bottom:0}@media screen and (min-width:760px){.text h1{font-size:3.5rem;line-height:4.5rem;margin-top:1.5rem}}@media screen and (min-width:900px){.text h1{font-size:4rem;line-height:4.5rem;margin-top:3rem}}@media screen and (min-width:1400px){.text h1{font-size:5rem;line-height:6rem;margin-top:6rem}}.text h2{font-size:2rem;line-height:3rem;margin-top:3rem;margin-bottom:3rem}.text h3{font-size:1.5rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h4{font-size:1rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h5{font-size:.8rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h6{font-size:.6rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text strong{font-weight:700}.text em{font-style:italic}.text blockquote{border-left:.2rem solid #999;padding-left:.75rem}.text code{font-family:lucida console,Monaco,monospace;speak:literal-punctuation}.text abbr,.text acronym{speak:spell-out}.text del{text-decoration:line-through}.text ins{text-decoration:none;font-style:italic}.text figure{position:relative;text-align:center}.text figure img{background:#fff;border-radius:.2rem;max-width:100%}.text figure table{min-width:75%;border-radius:.2rem;margin-left:auto;margin-right:auto;border:#6761a8;border-collapse:separate;border-spacing:0;background:#fff;margin-bottom:-.1em}.text figure table th,.text figure table td{padding-left:.75rem;padding-right:.75rem;line-height:1.3rem;border-left:.1rem solid #6761a8;border-top:.1rem solid #6761a8}.text figure table thead{background-color:#fff}.text figure table tr td:last-child,.text figure table tr th:last-child{border-right:.1rem solid #6761a8}.text figure table tbody:last-child tr:last-child td{border-bottom:.1rem solid #6761a8}.text figure table thead:first-child tr:first-child th:first-child,.text figure table thead:first-child tr:first-child td:first-child{border-top-left-radius:.2rem}.text figure table thead:first-child tr:first-child,.text figure table thead:first-child tr:first-child th:last-child,.text figure table thead:first-child tr:first-child td:last-child{border-top-right-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:first-child{border-bottom-left-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:last-child{border-bottom-right-radius:.2rem}.text figure ul{text-align:left}.text figure ul.tree{padding-top:1.5em;padding-bottom:1.5em;border-radius:.2rem;background:#fff}.text figure ul.tree li{list-style-type:none}.text figure ul.tree .tree__item--folder::before{content:"📁";margin-right:.2em}.text figure ul.tree .tree__item--file::before{content:"📝";margin-right:.2em}.text figure figcaption{font-style:italic}.text pre{margin-top:1.5rem;font-size:inherit;line-height:1.5rem;padding:1.5rem 1.5rem .75rem;white-space:pre;overflow-x:scroll;overflow-y:hidden;scrollbar-color:#cccccc transparent;scrollbar-width:.75rem}.text pre::-webkit-scrollbar{margin-top:-.75rem;height:.75rem}.text pre::-webkit-scrollbar-track{background:0 0}.text pre::-webkit-scrollbar-thumb{height:.1rem;border-radius:.2rem;background:#ccc}.text hr{border:0;height:.2rem;background:#6761a8;margin-top:1.3rem}.text .admonition{position:relative}.text .admonition>*{padding-left:2rem}.text .admonition>:first-child::before{display:block;text-align:left;position:absolute;top:0;left:0;width:.75rem;font-size:1rem;line-height:1.5rem;height:1.5rem}.text .admonition--tip>:first-child::before{content:"☛";color:#00a000;font-size:1.5rem;line-height:1.5rem;height:1.5rem}.text .admonition--warning>:first-child::before{content:"⚠️";color:#fe7f2d}.text .admonition--info>:first-child::before{content:"ⓘ";color:#004966;font-weight:700}@media print{.text h1{margin-left:auto;margin-right:auto;margin-top:9rem;width:80%;font-variant:small-caps;text-align:center}.text--simple h1{margin-top:0}.text .meta{page-break-after:always;text-align:center;font-size:1.2rem;margin-top:1.5rem}.text .meta a{text-decoration:none}.text .meta time{display:none}.text .body p:first-of-type{margin-top:0}.text pre{padding:0;font-size:inherit;line-height:1.5rem;overflow:hidden;white-space:pre-wrap;word-break:break-all}}.text .podcasts{margin-top:1.5rem;text-align:center}.text a.podcast{display:block;height:3rem}.text a.podcast img{width:50%;max-width:200px}@media screen and (min-width:768px){.text .podcasts{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));grid-gap:1.5rem}.text a.podcast img{width:100%}}.text .tombstone{opacity:0}.paginator{margin-top:1.5rem;text-align:center}.paginator a{display:inline-block;text-decoration:none;border-radius:3px;color:#2a2d34;border:1px solid #2a2d34;transition:.2s background-color ease-in-out,.2s color ease-in-out,.2s border-color ease-in-out;height:1rem;width:1rem;line-height:1rem;font-size:.7rem;margin-left:.2rem;margin-right:.2rem}.paginator a:hover,.paginator a.active{background:#004966;color:#fefefe;border:1px solid #004966}@media screen and (min-width:768px){.paginator a{height:1.5rem;width:1.5rem;line-height:1.5rem;font-size:1rem}}@media screen and (min-width:900px){.paginator a{height:3rem;width:3rem;line-height:3rem;font-size:1.2rem}}html,body{font-family:Arial,sans-serif;scroll-behavior:smooth;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;line-height:1.5rem;font-feature-settings:"liga" 1;font-weight:500;font-size:18px}@media(min-width:900px){html,body{font-size:20px}}@media(min-width:1100px){html,body{font-size:22px}}@media(min-width:1800px){html,body{font-size:24px}}@media print{html,body{font-size:18px}}hr{border:0;height:2px;background-color:#fe7f2d;margin-top:1.5rem;margin-bottom:1.5rem}.text{position:relative}.text .meta{font-variant:small-caps}.text .meta .byline{display:none}.text .meta .line{display:inline-block}.text .meta .calendar{display:none}.text h1,.text h2,.text h3,.text h4,.text h5,.text h6{font-family:Georgia,palatino linotype,book antiqua,Palatino,times new roman,serif;font-weight:500;page-break-after:avoid}.text h1 a,.text h1 a:visited,.text h2 a,.text h2 a:visited,.text h3 a,.text h3 a:visited,.text h4 a,.text h4 a:visited,.text h5 a,.text h5 a:visited,.text h6 a,.text h6 a:visited{color:#2a2d34;text-decoration:none}.text p,.text ul,.text ol,.text figure,.text dl,.text hr{margin-top:1.5rem;font-size:1rem}.text q{font-style:italic}.text ul ul{margin-top:0}.text p>code,.text ul>code,.text ol>code,.text dt>code,.text dd>code,.text li>code{color:#009b72}.text button{cursor:pointer;display:inline-block;box-sizing:border-box;border:.1rem solid #6761a8;height:1.5rem;padding-left:.75rem;padding-right:.75rem;border-radius:.2rem;transition:color .233s ease-in-out,background-color .233s ease-in-out}.text button:hover{color:#fff;background-color:#6761a8}.text audio{display:block;width:100%;height:1.5rem;outline:none}.text audio span{line-height:1.5rem}.text dl{overflow:auto;position:relative}.text dt{font-weight:700}.text dd{padding-left:2rem}.text dd+dt{margin-top:1.5rem}.text ul{list-style-type:disc;padding-left:1.5rem}.text ol{list-style-type:decimal;padding-left:1.5rem}.text p{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.text h1{font-size:2.5rem;font-weight:500;line-height:3rem;margin-top:1.5rem;margin-bottom:0}@media screen and (min-width:760px){.text h1{font-size:3.5rem;line-height:4.5rem;margin-top:1.5rem}}@media screen and (min-width:900px){.text h1{font-size:4rem;line-height:4.5rem;margin-top:3rem}}@media screen and (min-width:1400px){.text h1{font-size:5rem;line-height:6rem;margin-top:6rem}}.text h2{font-size:2rem;line-height:3rem;margin-top:3rem;margin-bottom:3rem}.text h3{font-size:1.5rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h4{font-size:1rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h5{font-size:.8rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text h6{font-size:.6rem;line-height:1.5rem;margin-top:1.5rem;margin-bottom:1.5rem}.text strong{font-weight:700}.text em{font-style:italic}.text blockquote{border-left:.2rem solid #999;padding-left:.75rem}.text code{font-family:lucida console,Monaco,monospace;speak:literal-punctuation}.text abbr,.text acronym{speak:spell-out}.text del{text-decoration:line-through}.text ins{text-decoration:none;font-style:italic}.text figure{position:relative;text-align:center}.text figure img{background:#fff;border-radius:.2rem;max-width:100%}.text figure table{min-width:75%;border-radius:.2rem;margin-left:auto;margin-right:auto;border:#6761a8;border-collapse:separate;border-spacing:0;background:#fff;margin-bottom:-.1em}.text figure table th,.text figure table td{padding-left:.75rem;padding-right:.75rem;line-height:1.3rem;border-left:.1rem solid #6761a8;border-top:.1rem solid #6761a8}.text figure table thead{background-color:#fff}.text figure table tr td:last-child,.text figure table tr th:last-child{border-right:.1rem solid #6761a8}.text figure table tbody:last-child tr:last-child td{border-bottom:.1rem solid #6761a8}.text figure table thead:first-child tr:first-child th:first-child,.text figure table thead:first-child tr:first-child td:first-child{border-top-left-radius:.2rem}.text figure table thead:first-child tr:first-child,.text figure table thead:first-child tr:first-child th:last-child,.text figure table thead:first-child tr:first-child td:last-child{border-top-right-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:first-child{border-bottom-left-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:last-child{border-bottom-right-radius:.2rem}.text figure ul{text-align:left}.text figure ul.tree{padding-top:1.5em;padding-bottom:1.5em;border-radius:.2rem;background:#fff}.text figure ul.tree li{list-style-type:none}.text figure ul.tree .tree__item--folder::before{content:"📁";margin-right:.2em}.text figure ul.tree .tree__item--file::before{content:"📝";margin-right:.2em}.text figure figcaption{font-style:italic}.text pre{margin-top:1.5rem;font-size:inherit;line-height:1.5rem;padding:1.5rem 1.5rem .75rem;white-space:pre;overflow-x:scroll;overflow-y:hidden;scrollbar-color:#cccccc transparent;scrollbar-width:.75rem}.text pre::-webkit-scrollbar{margin-top:-.75rem;height:.75rem}.text pre::-webkit-scrollbar-track{background:0 0}.text pre::-webkit-scrollbar-thumb{height:.1rem;border-radius:.2rem;background:#ccc}.text hr{border:0;height:.2rem;background:#6761a8;margin-top:1.3rem}.text .admonition{position:relative}.text .admonition>*{padding-left:2rem}.text .admonition>:first-child::before{display:block;text-align:left;position:absolute;top:0;left:0;width:.75rem;font-size:1rem;line-height:1.5rem;height:1.5rem}.text .admonition--tip>:first-child::before{content:"☛";color:#00a000;font-size:1.5rem;line-height:1.5rem;height:1.5rem}.text .admonition--warning>:first-child::before{content:"⚠️";color:#fe7f2d}.text .admonition--info>:first-child::before{content:"ⓘ";color:#004966;font-weight:700}@media print{.text h1{margin-left:auto;margin-right:auto;margin-top:9rem;width:80%;font-variant:small-caps;text-align:center}.text--simple h1{margin-top:0}.text .meta{page-break-after:always;text-align:center;font-size:1.2rem;margin-top:1.5rem}.text .meta a{text-decoration:none}.text .meta time{display:none}.text .body p:first-of-type{margin-top:0}.text pre{padding:0;font-size:inherit;line-height:1.5rem;overflow:hidden;white-space:pre-wrap;word-break:break-all}}.text .podcasts{margin-top:1.5rem;text-align:center}.text a.podcast{display:block;height:3rem}.text a.podcast img{width:50%;max-width:200px}@media screen and (min-width:768px){.text .podcasts{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));grid-gap:1.5rem}.text a.podcast img{width:100%}}.text .tombstone{opacity:0}.text .chroma{font-size:.8rem;border-radius:.2rem}.text .chroma .lntd{vertical-align:top;padding:0;margin:0;border:0}.text .chroma .lntable{border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block}.text .chroma .hl{display:block;width:100%}.text .chroma .lnt{margin-right:.4em;padding:0 .4em}.text .chroma{color:#272822}@media screen{.text .chroma{background-color:#fafafa}}.text .chroma .err{color:#960050}.text .chroma .hl{background-color:#ffc}.text .chroma .lnt{margin-right:.4em;padding:0 .4em;color:#7f7f7f}.text .chroma .ln{color:#7f7f7f}.text .chroma .k{color:#00a8c8}.text .chroma .kc{color:#00a8c8}.text .chroma .kd{color:#00a8c8}.text .chroma .kn{color:#f92672}.text .chroma .kp{color:#00a8c8}.text .chroma .kr{color:#00a8c8}.text .chroma .kt{color:#00a8c8}.text .chroma .n{color:#111}.text .chroma .na{color:#75af00}.text .chroma .nb{color:#111}.text .chroma .bp{color:#111}.text .chroma .nc{color:#75af00}.text .chroma .no{color:#00a8c8}.text .chroma .nd{color:#75af00}.text .chroma .ni{color:#111}.text .chroma .ne{color:#75af00}.text .chroma .nf{color:#75af00}.text .chroma .fm{color:#111}.text .chroma .nl{color:#111}.text .chroma .nn{color:#111}.text .chroma .nx{color:#75af00}.text .chroma .py{color:#111}.text .chroma .nt{color:#f92672}.text .chroma .nv{color:#111}.text .chroma .vc{color:#111}.text .chroma .vg{color:#111}.text .chroma .vi{color:#111}.text .chroma .vm{color:#111}.text .chroma .l{color:#ae81ff}.text .chroma .ld{color:#d88200}.text .chroma .s{color:#d88200}.text .chroma .sa{color:#d88200}.text .chroma .sb{color:#d88200}.text .chroma .sc{color:#d88200}.text .chroma .dl{color:#d88200}.text .chroma .sd{color:#d88200}.text .chroma .s2{color:#d88200}.text .chroma .se{color:#8045ff}.text .chroma .sh{color:#d88200}.text .chroma .si{color:#d88200}.text .chroma .sx{color:#d88200}.text .chroma .sr{color:#d88200}.text .chroma .s1{color:#d88200}.text .chroma .ss{color:#d88200}.text .chroma .m{color:#ae81ff}.text .chroma .mb{color:#ae81ff}.text .chroma .mf{color:#ae81ff}.text .chroma .mh{color:#ae81ff}.text .chroma .mi{color:#ae81ff}.text .chroma .il{color:#ae81ff}.text .chroma .mo{color:#ae81ff}.text .chroma .o{color:#f92672}.text .chroma .ow{color:#f92672}.text .chroma .p{color:#111}.text .chroma .c{color:#75715e}.text .chroma .ch{color:#75715e}.text .chroma .cm{color:#75715e}.text .chroma .c1{color:#75715e}.text .chroma .cs{color:#75715e}.text .chroma .cp{color:#75715e}.text .chroma .cpf{color:#75715e}.text .chroma .ge{font-style:italic}.text .chroma .gs{font-weight:700}</style><meta name=color-scheme content="dark light"></head><body><header><div class=page-header><div class=logo><a href=/><img src="data:image/svg+xml,%3Csvg baseProfile=%22tiny%22 id=%22Capa_1%22 xmlns=%22http://www.w3.org/2000/svg%22 xmlns:xlink=%22http://www.w3.org/1999/xlink%22 viewBox=%220 0 650 210%22%3E%3Cg%3E%3Cg%3E%3Ccircle fill=%22%23fff%22 cx=%22100.91%22 cy=%22104.98%22 r=%2268.91%22/%3E%3Cg%3E%3Cpath fill=%22%23bf181a%22 d=%22M100.91 36.12C62.85 36.12 32 66.97 32 105.03c0 23.47 11.74 44.18 29.66 56.63v-56.63c0-21.68 17.57-39.25 39.25-39.25s39.25 17.57 39.25 39.25-17.57 39.25-39.25 39.25c-8.76.0-16.82-2.91-23.35-7.76v33.35c7.29 2.63 15.15 4.07 23.35 4.07 38.06.0 68.91-30.85 68.91-68.91s-30.86-68.91-68.91-68.91z%22/%3E%3Ccircle fill=%22%23efc700%22 cx=%22100.91%22 cy=%22105.03%22 r=%2222.96%22/%3E%3Cpath fill=%22%23e6b600%22 d=%22M100.91 84.32c12.3.0 22.31 9.68 22.9 21.83.02-.38.06-.75.06-1.13.0-12.68-10.28-22.96-22.96-22.96s-22.96 10.28-22.96 22.96c0 .38.04.75.06 1.13C78.6 94 88.61 84.32 100.91 84.32z%22/%3E%3C/g%3E%3C/g%3E%3Cpath fill=%22%233c3c3c%22 d=%22M213.3 128.11V81.98h19.29c10.51.0 17.3 6.16 17.3 15.7.0 9.39-7.11 15.95-17.3 15.95h-9.02v14.47H213.3zm18.71-23.13c4.84.0 7.61-2.66 7.61-7.29.0-4.54-2.7-7.04-7.61-7.04h-8.45v14.33H232.01z%22/%3E%3Cpolygon fill=%22%233c3c3c%22 points=%22272.12,128.11 272.12,81.98 304.8,81.98 304.8,90.71 282.39,90.71 282.39,100.36 302.88,100.36 302.88,109.15 282.39,109.15 282.39,119.38 304.87,119.38 304.87,128.11%22/%3E%3Cpath fill=%22%233c3c3c%22 d=%22M354.71 128.11l-8.2-14.35h-8.39v14.35h-10.26V81.98h20.89c10.24.0 16.85 6.24 16.85 15.89.0 6.29-3.19 11.52-8.56 14.12l9.56 16.11H354.71zM347.66 105.23c4.81.0 7.68-2.77 7.68-7.42.0-4.59-2.8-7.23-7.68-7.23h-9.53v14.65H347.66z%22/%3E%3Cpath fill=%22%233c3c3c%22 d=%22M470.47 129.01c-12.53.0-20.63-8.12-20.63-20.69v-6.53c0-12.57 8.1-20.69 20.63-20.69 12.72.0 20.63 7.93 20.63 20.69v6.53C491.1 121.08 483.19 129.01 470.47 129.01zm0-39.2c-6.59.0-10.37 4.2-10.37 11.52v7.43c0 7.32 3.78 11.52 10.37 11.52 6.59.0 10.36-4.2 10.36-11.52v-7.43C480.83 94.01 477.06 89.81 470.47 89.81z%22/%3E%3Cpolygon fill=%22%233c3c3c%22 points=%22543.01,128.11 524.48,99.79 524.48,128.11 514.41,128.11 514.41,81.98 523.93,81.98 542.46,110.3 542.46,81.98 552.53,81.98 552.53,128.11%22/%3E%3Cpath fill=%22%233c3c3c%22 d=%22M607.7 128.11l-3.01-9.41h-16.47l-3.01 9.41h-10.29l16.54-46.13h10.01L618 128.11H607.7zM601.98 110.29l-5.52-17.45-5.58 17.45h11.1z%22/%3E%3Cg%3E%3Cpath fill=%22%233c3c3c%22 d=%22M418.62 111.85c-.77 5.33-4.37 8.5-9.73 8.5-8.74.0-10.05-7.3-10.05-11.65v-7.3c0-4.35 1.31-11.65 10.05-11.65 5.35.0 8.95 3.15 9.73 8.45l9.52-1.42c-1.28-9.33-8.95-15.7-19.24-15.7-12.68.0-20.24 7.76-20.24 20.76v6.4c0 13 7.57 20.76 20.24 20.76 10.3.0 17.98-6.39 19.25-15.74L418.62 111.85z%22/%3E%3C/g%3E%3C/g%3E%3C/svg%3E" alt=Percona></a></div><input type=checkbox id=show-mobile-menu value=1 aria-hidden=true><div class=mobile-toggle aria-controls=mobile-menu aria-label="Open navigation" role=button><label for=show-mobile-menu id=hamburger><span class=hamburger-bar></span><span class=hamburger-bar></span><span class=hamburger-bar></span></label></div><div class=mobile-menu id=mobile-menu aria-labelledby=navigation-header role=dialog aria-modal=false aria-hidden=true><nav><ul><li><a href=/blog><span>Blog</span></a></li><li><a href=/resources><span>Resources</span></a></li><li><a href=/projects><span>Projects</span></a></li><li><a href=/contribute><span>Contribute</span></a></li></ul></nav></div></div></header><main class=page><div class=page-main><article class=text itemscope itemtype=https://schema.org/BlogPosting><meta itemprop=image content="https://percona.community/blog/2020/02/tarantool-new-instances-scaled.png"><meta itemprop=mainEntityOfPage content="https://percona.community/blog/2020-03-24-deploying-tarantool-cartridge-applications-with-zero-effort-part-1/"><meta itemprop=keywords content="author_pavel, Open Source Databases, Tarantool, Tools"><h1 itemprop="name headline">Deploying Tarantool Cartridge Applications with Zero Effort (Part 1)</h1><div class=meta><time datetime="2020-03-24 14:04:32 +0000 UTC" itemprop=datePublished><span class=line>March 24, 2020</span>
<span class=calendar><span class=day>24</span>
<span class=month-year>Mar 2020</span></span></time>
<span class=authors>by <a href=/authors/elizaveta_dokshina/>Elizaveta Dokshina</a></span></div><div itemprop=articleBody class=body><p>Tarantool is an open-source in-memory DB with a Lua application server on board. It&rsquo;s best used for apps that require high performance and horizontal scaling. Out of the box we support horizontal scaling via the <a href=https://github.com/tarantool/vshard target=_blank rel="noopener noreferrer">vshard</a> module. There are quite a few things that you have to keep in mind when you work on your business logic, though. Not ideal.</p><p>We made it easier. All the lessons learned from creating distributed apps resulted in a framework called <a href=https://habr.com/ru/company/mailru/blog/470812/ target=_blank rel="noopener noreferrer">Tarantool Cartridge</a>. It simplifies the whole app lifecycle – coding, testing, CI/CD, deployment, and support.</p><p>This article shows Tarantool Cartridge in action - what it does for you with a special Ansible role:</p><ul><li>deploys your app to the cluster</li><li>starts up all instances</li><li>unites the instances into a cluster</li><li>sets up authorisation</li><li>bootstraps vshard (horizontal scaling)</li><li>turns on automatic failover</li><li>patches cluster configuration</li><li>and keeps it all running smoothly!</li></ul><p>See all of that with schemas and screenshots of the web-based GUI. Let&rsquo;s dive right into it!</p><h2 id=starting-off-with-a-sample>Starting off with a sample</h2><p>Let us walk you through only some of the role&rsquo;s functions. You can always find a full description of all its features and input parameters in the <a href=https://github.com/tarantool/ansible-cartridge#ansible-role-tarantool-cartridge target=_blank rel="noopener noreferrer">documentation</a>. However, trying once is better than seeing it a hundred times, so let us deploy a small application.</p><p>Tarantool Cartridge has a <a href=https://github.com/tarantool/cartridge-cli/tree/master/examples/getting-started-app#application-example-based-on-tarantool-cartridge target=_blank rel="noopener noreferrer">tutorial</a> for creating a small Cartridge application that stores information about bank customers and their accounts, as well as provides an API for data management via HTTP. For this purpose, the application describes two possible roles that can be assigned to the instances: api and storage. Roles are Lua modules that implement some instance-specific functions and/or logic.</p><p>Cartridge itself does not say anything about how to start processes — it only provides an opportunity to configure the running instances. So, the rest of it is up to the user: distributing configuration files, running services, and configuring topology. But we&rsquo;re not going to do all of that — Ansible will do it for us.</p><h3 id=getting-down-to-action>Getting down to action</h3><p>First, let us deploy our application onto two virtual machines and set up a simple topology:</p><ul><li>The app-1 replica set will represent the api role that contains the vshard-router role. There will be just one instance.</li><li>The storage-1 replica set will represent the storage role (including the vshard-storage role) — here we will add two instances from different machines.</li></ul><p><figure><img sizes=100vw srcset="/blog/2020/02/tarantool-storage-1-replica-set_hu02310c703eba99af16a9b176f459e16a_174993_480x0_resize_q90_lanczos.jpeg 480w, /blog/2020/02/tarantool-storage-1-replica-set_hu02310c703eba99af16a9b176f459e16a_174993_768x0_resize_q90_lanczos.jpeg 768w, /blog/2020/02/tarantool-storage-1-replica-set_hu02310c703eba99af16a9b176f459e16a_174993_1024x0_resize_q90_lanczos.jpeg 1024w" src=/blog/2020/02/tarantool-storage-1-replica-set.jpeg alt="Storage-1 replicaset"></figure>To run the sample, we will need <a href=https://www.vagrantup.com/ target=_blank rel="noopener noreferrer">Vagrant</a> and <a href=https://www.ansible.com/ target=_blank rel="noopener noreferrer">Ansible</a> (version 2.8 or higher).</p><p>The role itself is stored in <a href=https://galaxy.ansible.com/docs/ target=_blank rel="noopener noreferrer">Ansible Galaxy</a> — a repository that allows you to share your work and use the ready-made roles.</p><p>Now clone the sample repository:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>$ git clone https://github.com/dokshina/deploy-tarantool-cartridge-app.git
$ cd deploy-tarantool-cartridge-app &amp;&amp; git checkout 1.0.0
</code></pre></div><p>Then deploy the virtual machines:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>$ vagrant up
</code></pre></div><p>After that, install the Tarantool Cartridge Ansible role:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>$ ansible-galaxy install tarantool.cartridge,1.1.0
</code></pre></div><p>And start the installed role:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>$ ansible-playbook -i hosts.yml playbook.yml
</code></pre></div><p>Now wait until the playbook process is finished, go to <a href=http://localhost:8181/admin/cluster/dashboard target=_blank rel="noopener noreferrer">http://localhost:8181/admin/cluster/dashboard</a> and enjoy the results:</p><p><figure><img sizes=100vw srcset="/blog/2020/02/tarantool-dashboard_hu9b68f50fc6fdeff48d60b1c59ae6b91b_132171_480x0_resize_lanczos_2.png 480w, /blog/2020/02/tarantool-dashboard_hu9b68f50fc6fdeff48d60b1c59ae6b91b_132171_768x0_resize_lanczos_2.png 768w, /blog/2020/02/tarantool-dashboard_hu9b68f50fc6fdeff48d60b1c59ae6b91b_132171_1024x0_resize_lanczos_2.png 1024w" src=/blog/2020/02/tarantool-dashboard.png alt="tarantool dashboard"></figure></p><p>You can upload the data now. Awesome, isn&rsquo;t it?</p><p>Now let&rsquo;s figure out how to work with it, and we may as well add another replica set to the topology.</p><h3 id=getting-deeper-into-details>Getting deeper into details</h3><p>So, what happened?</p><p>We got two virtual machines up and running and launched the Ansible playbook that configured our cluster. Now let&rsquo;s look inside the playbook.yml file:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>---
- name: Deploy my Tarantool Cartridge app
  hosts: all
  become: true
  become_user: root
  tasks:
  - name: Import Tarantool Cartridge role
    import_role:
      name: tarantool.cartridge
</code></pre></div><p>Nothing interesting happens here; let&rsquo;s launch the Ansible role called tarantool.cartridge.</p><p>The most important things (namely, the cluster configuration) is in the <a href=https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html target=_blank rel="noopener noreferrer">hosts.yml</a> inventory file:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>---
all:
  vars:
    # common cluster variables
    cartridge_app_name: getting-started-app
    cartridge_package_path: ./getting-started-app-1.0.0-0.rpm  # path to package

    cartridge_cluster_cookie: app-default-cookie  # cluster cookie

    # common ssh options
    ansible_ssh_private_key_file: ~/.vagrant.d/insecure_private_key
    ansible_ssh_common_args: &#39;-o IdentitiesOnly=yes -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no&#39;

  # INSTANCES
  hosts:
    storage-1:
      config:
        advertise_uri: &#39;172.19.0.2:3301&#39;
        http_port: 8181

    app-1:
      config:
        advertise_uri: &#39;172.19.0.3:3301&#39;
        http_port: 8182

    storage-1-replica:
      config:
        advertise_uri: &#39;172.19.0.3:3302&#39;
        http_port: 8183

  children:
    # GROUP INSTANCES BY MACHINES
    host1:
      vars:
        # first machine connection options
        ansible_host: 172.19.0.2
        ansible_user: vagrant

      hosts:  # instances to be started on the first machine
        storage-1:

    host2:
      vars:
        # second machine connection options
        ansible_host: 172.19.0.3
        ansible_user: vagrant

      hosts:  # instances to be started on the second machine
        app-1:
        storage-1-replica:

    # GROUP INSTANCES BY REPLICA SETS
    replicaset_app_1:
      vars:  # replica set configuration
        replicaset_alias: app-1
        failover_priority:
          - app-1  # leader
        roles:
          - &#39;api&#39;

      hosts:  # replica set instances
        app-1:

    replicaset_storage_1:
      vars:  # replica set configuration
        replicaset_alias: storage-1
        weight: 3
        failover_priority:
          - storage-1  # leader
          - storage-1-replica
        roles:
          - &#39;storage&#39;

      hosts:   # replica set instances
        storage-1:
        storage-1-replica:
</code></pre></div><p>All we need to do is learn how to manage instances and replica sets by modifying this file. Later on, we will add new sections to it. In order to avoid confusion while adding the sections, look at the final version of this file, or <code>hosts.updated.yml</code>, which is located in the sample repository.</p><p>In Ansible terms, each instance is a host (not to be confused with a physical server), i.e. the infrastructure node that Ansible will manage. For each host, we can specify connection parameters (such as <code>ansible_host</code> and <code>ansible_user</code>) and instance configuration.</p><p>The instance description is in the <code>hosts </code>section. Let&rsquo;s look into the configuration of the <code>storage-1</code> instance:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>---
all:
  vars:
    ...

  # INSTANCES
  hosts:
    storage-1:
      config:
        advertise_uri: &#39;172.19.0.2:3301&#39;
        http_port: 8181

  ...

</code></pre></div><p>In the <code>config</code> variable, we specified the instance parameters: <code>advertise URI</code> and <code>HTTP port</code>.</p><p>Below are the parameters of the <code>app-1</code> and <code>storage-1-replica</code> instances.</p><p>We should provide Ansible with connection parameters for each instance. It seems reasonable to group the instances by virtual machines. For this purpose, the instances are grouped together under <code>host1</code> and <code>host2</code>, and each group in the <code>vars</code> section contains the <code>ansible_host</code> and <code>ansible_user</code> parameter values for a single virtual machine. And the <code>hosts</code> section contains hosts (or instances) included in this group:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>---
all:
  vars:
    ...
  hosts:
    ...
  children:
    # GROUP INSTANCES BY MACHINES
    host1:
      vars:
        # first machine connection options
        ansible_host: 172.19.0.2
        ansible_user: vagrant
       hosts:  # instances to be started on the first machine
        storage-1:

     host2:
      vars:
        # second machine connection options
        ansible_host: 172.19.0.3
        ansible_user: vagrant
       hosts:  # instances to be started on the second machine
        app-1:
        storage-1-replica:

</code></pre></div><p>Let&rsquo;s start editing <code>hosts.yml</code>. Now we add two more instances: <code>storage-2-replica</code> on the first virtual machine and <code>storage-2</code> on the second one:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>---
all:
  vars:
    ...

  # INSTANCES
  hosts:
    ...
    storage-2:  # &lt;==
      config:
        advertise_uri: &#39;172.19.0.3:3303&#39;
        http_port: 8184

    storage-2-replica:  # &lt;==
      config:
        advertise_uri: &#39;172.19.0.2:3302&#39;
        http_port: 8185

  children:
    # GROUP INSTANCES BY MACHINES
    host1:
      vars:
        ...
      hosts:  # instances to be started on the first machine
        storage-1:
        storage-2-replica:  # &lt;==

    host2:
      vars:
        ...
      hosts:  # instances to be started on the second machine
        app-1:
        storage-1-replica:
        storage-2:  # &lt;==

</code></pre></div><p>Start the Ansible playbook:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>$ ansible-playbook -i hosts.yml 
                   --limit storage-2,storage-2-replica 
                   playbook.yml

</code></pre></div><p>Note the <code>--limit </code>option. Since each cluster instance is a host in terms of Ansible, we can explicitly specify which instances should be configured when running the playbook.</p><p>So we go back to the web UI at <a href=http://localhost:8181/admin/cluster/dashboard target=_blank rel="noopener noreferrer">http://localhost:8181/admin/cluster/dashboard</a> and look at our new instances:<figure><img sizes=100vw srcset="/blog/2020/02/tarantool-new-instances_hue0b97d7e673180d5b36d59e422032731_154904_480x0_resize_lanczos_2.png 480w, /blog/2020/02/tarantool-new-instances_hue0b97d7e673180d5b36d59e422032731_154904_768x0_resize_lanczos_2.png 768w, /blog/2020/02/tarantool-new-instances_hue0b97d7e673180d5b36d59e422032731_154904_1024x0_resize_lanczos_2.png 1024w" src=/blog/2020/02/tarantool-new-instances.png alt="Tarantool new instances in dashboard"></figure></p><p>Next, let&rsquo;s master topology management.</p><h3 id=managing-the-topology>Managing the topology</h3><p>Let us group our new instances into the storage-2 replica set, add a new group of replicaset_storage_2, and describe the replica set parameters in the variables as we did for replicaset_storage_1. In the hosts section, we specify which instances should be included in this group (i.e. our replica set):</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>---
all:
  vars:
    ...
  hosts:
    ...
  children:
    ...
    # GROUP INSTANCES BY REPLICA SETS
    ...
    replicaset_storage_2:  # &lt;==
      vars:  # replicaset configuration
        replicaset_alias: storage-2
        weight: 2
        failover_priority:
          - storage-2
          - storage-2-replica
        roles:
          - &#39;storage&#39;

      hosts:   # replicaset instances
        storage-2:
        storage-2-replica:

</code></pre></div><p>Then we run the playbook again:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>$ ansible-playbook -i hosts.yml 
                   --limit replicaset_storage_2 
                   --tags cartridge-replicasets 
                   playbook.yml
</code></pre></div><p>This time we pass the name of the group corresponding to our replica set in the <code>--limit</code> parameter.</p><p>Let&rsquo;s look at the <code>tags</code> option.</p><p>Our role successively executes various tasks marked with the following tags:</p><ul><li><code>cartridge-instances</code>: instance management (configuration, membership);</li><li><code>cartridge-replicasets</code>: topology management (replica set management and permanent removal (expel) of instances from the cluster);</li><li><code>cartridge-config</code>: control of other cluster parameters (vshard bootstrapping, automatic failover, authorization parameters, and application configuration).</li></ul><p>We can explicitly specify what part of the work we want to be done — and the role will skip the rest of the tasks. In this case, we only want to work with topology, so we specify <code>cartridge-replicasets</code>.</p><p>Let us evaluate the result of our efforts. Find the new replica set at<a href=http://localhost:8181/admin/cluster/dashboard target=_blank rel="noopener noreferrer"> http://localhost:8181/admin/cluster/dashboard</a>.</p><p><figure><img sizes=100vw srcset="/blog/2020/02/tarantool-new-replicaset_huf212f201e75fdb6025484a4fc6fc5b70_285204_480x0_resize_lanczos_2.png 480w, /blog/2020/02/tarantool-new-replicaset_huf212f201e75fdb6025484a4fc6fc5b70_285204_768x0_resize_lanczos_2.png 768w, /blog/2020/02/tarantool-new-replicaset_huf212f201e75fdb6025484a4fc6fc5b70_285204_1024x0_resize_lanczos_2.png 1024w" src=/blog/2020/02/tarantool-new-replicaset.png alt="Tarantool new replicaset"></figure></p><p>Yay!</p><p>Try changing the configuration of the instances and replica sets and see how the topology of the cluster changes. You can try different use cases, such as <a href=https://docs.ansible.com/ansible/latest/user_guide/playbooks_delegation.html#rolling-update-batch-size target=_blank rel="noopener noreferrer">rolling update</a> or <code>memtx_memory</code> increase. The role would try to do this without restarting the instance to reduce the possible downtime of your application.</p><p>Don&rsquo;t forget to run <code>vagrant halt</code> to stop the virtual machines when you&rsquo;re done with them.</p><h2 id=whats-inside>What&rsquo;s inside?</h2><p>Here I will tell you more about what happened under the hood of the Ansible role during our tests.</p><p>Let&rsquo;s consider the steps of deploying a Cartridge application.</p><h3 id=installing-the-package-and-starting-the-instances>Installing the package and starting the instances</h3><p>The first thing to do is to deliver the package to the server and install it. Now the role can work with RPM-packages and DEB-packages.</p><p>Next, we launch the instances. It is very simple: every instance is a separate <code>systemd</code> service. For example:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>$ systemctl start myapp@storage-1
</code></pre></div><p>This command launches the <code>storage-1</code> instance of the <code>myapp</code> application. The running instance looks for its <a href=https://www.tarantool.io/ru/doc/2.2/book/cartridge/cartridge_dev/#configuring-instances target=_blank rel="noopener noreferrer">configuration</a> in <code>/etc/tarantool/conf.d/</code>. You can view the instance logs using <code>journald</code>.</p><p>The Unit file <code>/etc/systemd/systemd/myapp@.sevice</code> for the systemd service is delivered with the package.</p><p>Ansible has built-in modules for installing packages and managing systemd services, so we did not invent anything new here.</p><h3 id=configuring-the-cluster-topology>Configuring the cluster topology</h3><p>The most exciting things happen here. I am sure you would agree that it is strange to bother with a special Ansible role for installing packages and running <code>systemd</code> services.</p><p>You can configure the cluster manually:</p><ul><li>The first option is to open the Web UI and click on the buttons. It is quite suitable for a one-time start of several instances.</li><li>The second option is to use GraphQL API. Here you can already automate something, for example, write a script in Python.</li><li>The third option is for the courageous: go to the server, connect to one of the instances with the help of <code>tarantoolctl connect</code> and perform all the necessary actions with the <code>cartridge </code>Lua module.</li></ul><p>The main task of our invention is to do this most difficult part of the work for you.</p><p>Ansible allows you to write your own module and use it in your role. Our role uses these modules to manage the various cluster components.</p><p>How does it work? You describe the desired state of the cluster in a declarative configuration, and the role gives each module its own configuration section as input. The module receives the current state of the cluster and compares it with the input. Then the code for the necessary cluster state is launched using the socket of one of the instances.</p><h2 id=results>Results</h2><p>Today we have shown you how to deploy your Tarantool Cartridge application and configure a simple topology. To do this, we used Ansible, a powerful tool that is easy to use and allows you to configure multiple infrastructure nodes at the same time (in our case, the cluster instances).</p><p>Above we went over one of the many ways to describe the cluster configuration by means of Ansible. Once you feel that you are ready for more, learn the <a href=https://docs.ansible.com/ansible/latest/user_guide/playbooks_best_practices.html target=_blank rel="noopener noreferrer">best practices</a> for writing playbooks. You may find it easier to manage the topology with <code>group_vars</code> and <code>host_vars</code>.</p><p>Very soon, we will tell you how to remove (expel) instances from the topology permanently, bootstrap vshard, manage automatic failover, configure authorization, and patch cluster configuration. In the meantime, you can review the <a href=https://github.com/tarantool/ansible-cartridge#ansible-role-tarantool-cartridge target=_blank rel="noopener noreferrer">documentation</a> yourself and try changing cluster settings.</p><p>If something goes wrong, make sure to <a href=https://github.com/tarantool/ansible-cartridge/issues/new target=_blank rel="noopener noreferrer">let us know</a> about the problem. We will do our best to resolve any issue! <span aria-label="End of article." role=text class=tombstone>∎</span></p></div></article></div></main><footer class=page><h1 class=aria-only id=footer-heading aria-hidden=false>Footer</h1><div class=page-footer><nav class=footer><ul><li><a href=https://www.percona.com/about-percona target=_blank rel="noopener noreferrer"><span>About</span></a></li><li><a href=https://www.percona.com/legal target=_blank rel="noopener noreferrer"><span>Legal</span></a></li><li><a href=https://forums.percona.com/ target=_blank rel="noopener noreferrer"><span>Forums</span></a></li><li><a href=https://www.percona.com/about-percona/contact target=_blank rel="noopener noreferrer"><span>Contact</span></a></li></ul></nav></div><aside>© Percona Community. MySQL, InnoDB, MariaDB and MongoDB are trademarks of their respective owners.</aside></footer><script type=text/javascript src=https://percona.community/js/aria.5f30892348d4662fe548bb410f15fc6fe2e1cbfd6473beb3c3ed1d6b362568bbea48896a9f2302a4f78f4614904ca3ef43155ae26f063ed84ae957f951e19647.js integrity="sha512-XzCJI0jUZi/lSLtBDxX8b+Lhy/1kc76zw+0dazYlaLvqSIlqnyMCpPePRhSQTKPvQxVa4m8GPthK6Vf5UeGWRw==" defer></script></body></html>